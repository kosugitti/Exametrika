(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49415,       1224]
NotebookOptionsPosition[     46447,       1169]
NotebookOutlinePosition[     46885,       1186]
CellTagsIndexPosition[     46842,       1183]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"datafile", "=", "\"\<J35S515.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemlabelrow", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"studentIDcolumn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mi", "=", 
   RowBox[{"-", "99"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minclssize", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"dir", "<>", "\"\<mod/Module_CTT.nb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemstat", "[", "data", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.899433254082926*^9, 3.899433385571013*^9}},
 CellLabel->
  "In[1207]:=",ExpressionUUID->"7f8cc05e-002f-473e-9648-4444ac58946a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Test Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.8994334151129704`*^9, 3.899433510472118*^9, 3.899494840537462*^9, 
   3.899494924446306*^9, 3.899496282704661*^9, 3.8994964136322937`*^9, 
   3.899752095346925*^9, 3.899752134012883*^9, {3.8997521688945427`*^9, 
   3.899752176866082*^9}, 3.899755361285264*^9, {3.899755954221155*^9, 
   3.8997559730865602`*^9}, 3.8997561237581453`*^9, {3.899756197151911*^9, 
   3.8997562153197727`*^9}, 3.899756613628969*^9, 3.899756722644836*^9, {
   3.899756847293572*^9, 3.899756868579762*^9}, 3.899868461913837*^9, 
   3.899868497863044*^9, 3.899868746691175*^9, 3.899870098064836*^9, 
   3.900012172769659*^9, 3.9000148773530483`*^9, 3.90019315723943*^9, 
   3.900194024720297*^9, 3.900194119044126*^9, {3.900194363147603*^9, 
   3.900194385389752*^9}, 3.900194452629525*^9, 3.904851963458826*^9, 
   3.9048577992240467`*^9, 3.90502274844869*^9, 3.9050228188776903`*^9, 
   3.9050232393669853`*^9, 3.905023350682869*^9, 3.905023421782634*^9, 
   3.9050234632257843`*^9, 3.905023550611926*^9, 3.9050251540807467`*^9, 
   3.90502528161018*^9, 3.9050254173306723`*^9, 3.9050256593290167`*^9, 
   3.905025827944888*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"e586ba05-1762-4098-8591-\
712175e79b94"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"N of Items\"\>", "35"},
     {"\<\"Sample Size\"\>", "515"},
     {"\<\"Mean\"\>", "12.749514563106796`"},
     {"\<\"SE of Mean\"\>", "0.3567865140306771`"},
     {"\<\"SD\"\>", "8.096774514953083`"},
     {"\<\"Skewness\"\>", "0.7703382465193783`"},
     {"\<\"Kurtosis\"\>", "0.0359465678636659`"},
     {"\<\"Min\"\>", "0"},
     {"\<\"Max\"\>", "35"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.8994334151129704`*^9, 3.899433510472118*^9, 3.899494840537462*^9, 
   3.899494924446306*^9, 3.899496282704661*^9, 3.8994964136322937`*^9, 
   3.899752095346925*^9, 3.899752134012883*^9, {3.8997521688945427`*^9, 
   3.899752176866082*^9}, 3.899755361285264*^9, {3.899755954221155*^9, 
   3.8997559730865602`*^9}, 3.8997561237581453`*^9, {3.899756197151911*^9, 
   3.8997562153197727`*^9}, 3.899756613628969*^9, 3.899756722644836*^9, {
   3.899756847293572*^9, 3.899756868579762*^9}, 3.899868461913837*^9, 
   3.899868497863044*^9, 3.899868746691175*^9, 3.899870098064836*^9, 
   3.900012172769659*^9, 3.9000148773530483`*^9, 3.90019315723943*^9, 
   3.900194024720297*^9, 3.900194119044126*^9, {3.900194363147603*^9, 
   3.900194385389752*^9}, 3.900194452629525*^9, 3.904851963458826*^9, 
   3.9048577992240467`*^9, 3.90502274844869*^9, 3.9050228188776903`*^9, 
   3.9050232393669853`*^9, 3.905023350682869*^9, 3.905023421782634*^9, 
   3.9050234632257843`*^9, 3.905023550611926*^9, 3.9050251540807467`*^9, 
   3.90502528161018*^9, 3.9050254173306723`*^9, 3.9050256593290167`*^9, 
   3.905025827946151*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"3fcb788c-0393-4981-9a50-\
7e8c80d2b571"],

Cell[BoxData["\<\"Item Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.8994334151129704`*^9, 3.899433510472118*^9, 3.899494840537462*^9, 
   3.899494924446306*^9, 3.899496282704661*^9, 3.8994964136322937`*^9, 
   3.899752095346925*^9, 3.899752134012883*^9, {3.8997521688945427`*^9, 
   3.899752176866082*^9}, 3.899755361285264*^9, {3.899755954221155*^9, 
   3.8997559730865602`*^9}, 3.8997561237581453`*^9, {3.899756197151911*^9, 
   3.8997562153197727`*^9}, 3.899756613628969*^9, 3.899756722644836*^9, {
   3.899756847293572*^9, 3.899756868579762*^9}, 3.899868461913837*^9, 
   3.899868497863044*^9, 3.899868746691175*^9, 3.899870098064836*^9, 
   3.900012172769659*^9, 3.9000148773530483`*^9, 3.90019315723943*^9, 
   3.900194024720297*^9, 3.900194119044126*^9, {3.900194363147603*^9, 
   3.900194385389752*^9}, 3.900194452629525*^9, 3.904851963458826*^9, 
   3.9048577992240467`*^9, 3.90502274844869*^9, 3.9050228188776903`*^9, 
   3.9050232393669853`*^9, 3.905023350682869*^9, 3.905023421782634*^9, 
   3.9050234632257843`*^9, 3.905023550611926*^9, 3.9050251540807467`*^9, 
   3.90502528161018*^9, 3.9050254173306723`*^9, 3.9050256593290167`*^9, 
   3.9050258279478407`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"881e9553-07a0-473e-865f-\
6205a8aa0ced"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Item\"\>", "\<\"Number of Respondents\"\>", "\<\"Correct Response \
Rate\"\>", "\<\"Item Threshold\"\>", "\<\"Item-Total Correlation\"\>"},
     {"\<\"Item01\"\>", "515", "0.8504854368932039`", 
      RowBox[{"-", "1.038517641955578`"}], "0.3713495176934055`"},
     {"\<\"Item02\"\>", "515", "0.39223300970873787`", "0.2735037378950026`", 
      "0.6656857153200353`"},
     {"\<\"Item03\"\>", "515", "0.458252427184466`", "0.10483737262774764`", 
      "0.5424516101473047`"},
     {"\<\"Item04\"\>", "515", "0.3029126213592233`", "0.5160417605007561`", 
      "0.6392543201065256`"},
     {"\<\"Item05\"\>", "515", "0.2504854368932039`", "0.6729629316411024`", 
      "0.6122765729913002`"},
     {"\<\"Item06\"\>", "515", "0.21553398058252426`", "0.7873654581038404`", 
      "0.611676651387653`"},
     {"\<\"Item07\"\>", "515", "0.5728155339805825`", 
      RowBox[{"-", "0.18354688834314817`"}], "0.40097552917337825`"},
     {"\<\"Item08\"\>", "515", "0.34951456310679613`", "0.386631376099102`", 
      "0.34976069503275703`"},
     {"\<\"Item09\"\>", "515", "0.39029126213592236`", "0.2785599858125778`", 
      "0.4711715165784889`"},
     {"\<\"Item10\"\>", "515", "0.3533980582524272`", "0.376162467273338`", 
      "0.47492802963027025`"},
     {"\<\"Item11\"\>", "515", "0.47572815533980584`", "0.06087807498546322`",
       "0.7250558590768102`"},
     {"\<\"Item12\"\>", "515", "0.33980582524271846`", "0.41299312538917526`",
       "0.6281614727335694`"},
     {"\<\"Item13\"\>", "515", "0.23689320388349513`", "0.7163319422655497`", 
      "0.5677541174939663`"},
     {"\<\"Item14\"\>", "515", "0.1262135922330097`", "1.1444738312523375`", 
      "0.6091023364528331`"},
     {"\<\"Item15\"\>", "515", "0.08737864077669903`", "1.3570753132816924`", 
      "0.5593391821716797`"},
     {"\<\"Item16\"\>", "515", "0.21553398058252426`", "0.7873654581038404`", 
      "0.6070153872334288`"},
     {"\<\"Item17\"\>", "515", "0.2757281553398058`", "0.5955792968709146`", 
      "0.5257090351255301`"},
     {"\<\"Item18\"\>", "515", "0.04854368932038835`", "1.6591410224234104`", 
      "0.4127690804300786`"},
     {"\<\"Item19\"\>", "515", "0.05242718446601942`", "1.6217617612083302`", 
      "0.41573744931877876`"},
     {"\<\"Item20\"\>", "515", "0.05436893203883495`", "1.603891983892223`", 
      "0.4268923577811534`"},
     {"\<\"Item21\"\>", "515", "0.6155339805825243`", 
      RowBox[{"-", "0.29377212223106125`"}], "0.6877248571783768`"},
     {"\<\"Item22\"\>", "515", "0.5864077669902913`", 
      RowBox[{"-", "0.21831400139733484`"}], "0.6896688457112237`"},
     {"\<\"Item23\"\>", "515", "0.6`", 
      RowBox[{"-", "0.2533471031357998`"}], "0.6100406707370244`"},
     {"\<\"Item24\"\>", "515", "0.566990291262136`", 
      RowBox[{"-", "0.16871678252646105`"}], "0.6542825476761968`"},
     {"\<\"Item25\"\>", "515", "0.4912621359223301`", "0.021904328645649434`",
       "0.7195211128578042`"},
     {"\<\"Item26\"\>", "515", "0.4524271844660194`", "0.1195313947295636`", 
      "0.7429019527247144`"},
     {"\<\"Item27\"\>", "515", "0.41359223300970877`", "0.21831400139733456`",
       "0.6841748312819268`"},
     {"\<\"Item28\"\>", "515", "0.22135922330097088`", "0.7676107958854407`", 
      "0.677820612725525`"},
     {"\<\"Item29\"\>", "515", "0.22718446601941747`", "0.7481512500500589`", 
      "0.5851096914681957`"},
     {"\<\"Item30\"\>", "515", "0.0854368932038835`", "1.3694015615706736`", 
      "0.4414223809905667`"},
     {"\<\"Item31\"\>", "515", "0.8116504854368932`", 
      RowBox[{"-", "0.8839947829217846`"}], "0.34909235005893596`"},
     {"\<\"Item32\"\>", "515", "0.8077669902912621`", 
      RowBox[{"-", "0.8696969867177557`"}], "0.26034561653662286`"},
     {"\<\"Item33\"\>", "515", "0.4368932038834951`", "0.15885082097374867`", 
      "0.3837006938909515`"},
     {"\<\"Item34\"\>", "515", "0.229126213592233`", "0.7417275452057569`", 
      "0.2859237182345218`"},
     {"\<\"Item35\"\>", "515", "0.1553398058252427`", "1.013797032381492`", 
      "0.3472703507353228`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.8994334151129704`*^9, 3.899433510472118*^9, 3.899494840537462*^9, 
   3.899494924446306*^9, 3.899496282704661*^9, 3.8994964136322937`*^9, 
   3.899752095346925*^9, 3.899752134012883*^9, {3.8997521688945427`*^9, 
   3.899752176866082*^9}, 3.899755361285264*^9, {3.899755954221155*^9, 
   3.8997559730865602`*^9}, 3.8997561237581453`*^9, {3.899756197151911*^9, 
   3.8997562153197727`*^9}, 3.899756613628969*^9, 3.899756722644836*^9, {
   3.899756847293572*^9, 3.899756868579762*^9}, 3.899868461913837*^9, 
   3.899868497863044*^9, 3.899868746691175*^9, 3.899870098064836*^9, 
   3.900012172769659*^9, 3.9000148773530483`*^9, 3.90019315723943*^9, 
   3.900194024720297*^9, 3.900194119044126*^9, {3.900194363147603*^9, 
   3.900194385389752*^9}, 3.900194452629525*^9, 3.904851963458826*^9, 
   3.9048577992240467`*^9, 3.90502274844869*^9, 3.9050228188776903`*^9, 
   3.9050232393669853`*^9, 3.905023350682869*^9, 3.905023421782634*^9, 
   3.9050234632257843`*^9, 3.905023550611926*^9, 3.9050251540807467`*^9, 
   3.90502528161018*^9, 3.9050254173306723`*^9, 3.9050256593290167`*^9, 
   3.905025827948995*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"a5e0dc42-e880-41ef-8ead-\
562a1710dee8"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samefieldcount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxsamefieldcount", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"const", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamc", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamf", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxt", "=", "50"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximum", " ", "number", " ", "of", " ", "iterations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nrightpat", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", "totalscore", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerogroup", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nrightpat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", "1", ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullgroup", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nrightpat", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", "testlength"}], ",", 
     "1", ",", "0"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899433446758898*^9, 3.899433494753141*^9}, {
   3.899492559790842*^9, 3.899492584789906*^9}, {3.8994937246219797`*^9, 
   3.8994937298587313`*^9}, {3.89975261348067*^9, 3.8997526151576843`*^9}, {
   3.899752921800889*^9, 3.899752928083226*^9}, {3.905022674625073*^9, 
   3.905022681312895*^9}, {3.905022768118585*^9, 3.9050227699532013`*^9}, {
   3.905022812882251*^9, 3.905022814309558*^9}, 3.9050233289200687`*^9},
 CellLabel->
  "In[1215]:=",ExpressionUUID->"4a26cfd6-e625-4a81-b0dd-3b35ed615a50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nclass", "=", 
    RowBox[{"Length", "[", "nrightpat", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "initial", " ", "value", " ", "for", " ", "the", " ", "number",
     " ", "of", " ", "classes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class01", "=", 
   RowBox[{"1", "-", 
    RowBox[{"Sign", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{"totalscore", "-", 
       RowBox[{"Table", "[", 
        RowBox[{"nrightpat", ",", 
         RowBox[{"{", "samplesize", "}"}]}], "]"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class", "=", 
   RowBox[{"class01", ".", 
    RowBox[{"Table", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nclass"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nc", "=", 
   RowBox[{"Total", "[", "class01", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nfield", "=", "testlength"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "initial", " ", "value", " ", "for", " ", "the", " ", "number",
     " ", "of", " ", "fields"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemnum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"j", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"crr", ",", "itemnum"}], "}"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "itemnum"}], "}"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"field01", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "testlength", "}"}], ",", 
     RowBox[{"{", "nfield", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"field01", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", 
        RowBox[{"field", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nf", "=", 
   RowBox[{"Total", "[", "field01", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPa36nPMU3reOKnmPwXTFhd1KG4H0sYod+iBaRGSC
CYg+n7EFTB9jq3Q04HvreLy5B0wXaVoEgOj9V5vAtFPinmgQHfT0ZyyIvqH2
Lw1EJz0VSgfRXnXNtSB6R7pfA4i+zGbcBqKXs+1vB9Grvq7rA9G/1hwC09FO
1tNAtM4D4xkg2uiJ22IQzSFVBqb3znZaDqIrsmLANFuv1BsQvenzl7cgevY1
7d8g2v6YKZhmOjzT6JX4W0eXqcuNQfQTHddcOQmge7e1FIHoJ3EqTSD69tQ5
YFo+MjLGFkgrK2SDaQD1LIYs
  "],
 CellLabel->
  "In[1226]:=",ExpressionUUID->"9b75d60d-e652-4522-8018-d54ab9256230"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "initial", " ", "value", " ", "for", " ", "the", " ", 
    "parameter", " ", "set", " ", "and", " ", "the", " ", "model", " ", 
    "fit"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ccf", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "class01", "]"}], ".", "uuu", ".", 
      "field01"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fcf", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "class01", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"zzz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "uuu"}], ")"}]}], ")"}], ".", "field01"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ncf", "=", 
     RowBox[{"Ccf", "+", "Fcf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pcf", "=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ccf", "+", "gamp", "-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"Ncf", "+", 
         RowBox[{"2", "gamp"}], "-", "2"}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"zerogroup", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{"Pcf", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "nfield", "}"}]}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fullgroup", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{"Pcf", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", "nfield", "}"}]}], "]"}]}]}], "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.899433528865484*^9, 3.899433531125094*^9}, {
  3.8994928259716587`*^9, 3.899492837735029*^9}, {3.899492881310656*^9, 
  3.899492883593704*^9}, {3.8997522277477207`*^9, 3.8997522584254913`*^9}, {
  3.899755193609047*^9, 3.899755193900894*^9}, {3.899755254045225*^9, 
  3.899755265496902*^9}, {3.905022700362782*^9, 3.905022700555781*^9}},
 CellLabel->
  "In[1236]:=",ExpressionUUID->"4a1d0910-2644-42d7-a327-ec67c2a9d80c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Gibbs", " ", "sampler", " ", "i"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Cif", "=", 
     RowBox[{"uuu", ".", "field01"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fif", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zzz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "uuu"}], ")"}]}], ")"}], ".", "field01"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"irand", "=", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", "samplesize", "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "samplesize"}], "}"}]}], "]"}]}], 
         "}"}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.899493568318088*^9, 3.899493577548073*^9}, {
  3.905022705348296*^9, 3.905022705512623*^9}},
 CellLabel->
  "In[1242]:=",ExpressionUUID->"a8a0049b-4ad4-4a65-bc01-aa7b4dcb22be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ri", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", 
   RowBox[{"irand", "[", 
    RowBox[{"[", "ri", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "17"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nc", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Nc", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ncf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ncf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "Nf"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ccf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ccf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
    RowBox[{"Cif", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fcf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Fcf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
    RowBox[{"Fif", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ccfplus", "=", 
   RowBox[{"Ccf", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Cif", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", "nclass", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fcfplus", "=", 
   RowBox[{"Fcf", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Fif", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", "nclass", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXbLadd5G3reOc878Xgqit0Rv3wCiT91ftxtEe+46
p7oJSDektOqA6M9Fzs9AtIOn53MQvW1e0g8QbWLk8xtE91WsPqDP99ZR4AXv
JRD978vHayDa9YbZDRC9jFHvDog2Obr8Loj+OCFisyGQPmQstgNEp908egxE
h6Q9BtP7mHdcBtGNP/2vgegJ0c7sRkBa5u97MB33/JgoiNZyegims9SnyoPo
b4ujFEC0kVS7CoheMvebOogum3pOn53/reOqSdfBdJzg+qUg2uqW4jIQveM1
53EQrZZ2+SSIvqCrewlES07QB9NHdaStXom/dZwovQZMAwAxiZPy
  "],
 CellLabel->
  "In[1245]:=",ExpressionUUID->"5f1db319-317b-4f4e-aeb4-5f8b1b58bcf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Sum", " ", "Log", " ", "Version"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"existtab", "=", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"Nc", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"samplesize", "-", "1", "+", "gamc"}], ")"}]}], "]"}], "+",
         "const"}], "]"}], "+", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Log", "[", 
               RowBox[{
                RowBox[{"Ccfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", 
                "1", "-", "s", "+", "const"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "0", ",", 
               RowBox[{
                RowBox[{"Ccfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
                RowBox[{"Ccf", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], 
              "}"}]}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Log", "[", 
               RowBox[{
                RowBox[{"Fcfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", 
                "1", "-", "s", "+", "const"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "0", ",", 
               RowBox[{
                RowBox[{"Fcfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
                RowBox[{"Fcf", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], 
              "}"}]}], "]"}], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Log", "[", 
               RowBox[{
                RowBox[{"Ccfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
                RowBox[{"Fcfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
                RowBox[{"2", "gamp"}], "-", "1", "-", "s", "+", "const"}], 
               "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "0", ",", 
               RowBox[{
                RowBox[{"Ccfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
                RowBox[{"Fcfplus", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
                RowBox[{"Ccf", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
                RowBox[{"Fcf", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", "nfield"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "2", ",", 
          RowBox[{"nclass", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newtab", "=", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"gamc", "/", 
          RowBox[{"(", 
           RowBox[{"samplesize", "-", "1", "+", "gamc"}], ")"}]}], "]"}], "+",
         "const"}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Cif", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", "1", 
              "-", "s", "+", "const"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Cif", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "f"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Nf", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "-", 
              RowBox[{"Cif", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", "1", 
              "-", "s", "+", "const"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Nf", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "-", 
              RowBox[{"Cif", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "f"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Nf", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "+", 
              RowBox[{"2", "gamp"}], "-", "1", "-", "s", "+", "const"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Nf", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "1", ",", "nfield"}], "}"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.899494876718713*^9, 3.8994948871285057`*^9}, {
   3.89986845379638*^9, 3.8998684941696243`*^9}, {3.899868536659438*^9, 
   3.899868592893696*^9}, {3.899868625350264*^9, 3.899868633423696*^9}, 
   3.899870088543334*^9, {3.904852445118958*^9, 3.904852453690226*^9}, {
   3.904852498019437*^9, 3.904852561724752*^9}, {3.904858010462924*^9, 
   3.904858014697682*^9}, {3.9048624488071737`*^9, 3.9048624499876127`*^9}, {
   3.905022719074649*^9, 3.905022719256625*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"7e8393a0-72ba-4c71-8abb-8d85fcac0b93"],

Cell[CellGroupData[{

Cell[BoxData["existtab"], "Input",
 CellChangeTimes->{{3.899494900052326*^9, 3.8994949024508247`*^9}, {
  3.899869972968231*^9, 3.8998699927105017`*^9}, {3.899870044123687*^9, 
  3.8998700466845093`*^9}, {3.899871172195794*^9, 3.899871175050548*^9}, {
  3.900015275381765*^9, 3.900015283062006*^9}},
 CellLabel->
  "In[1256]:=",ExpressionUUID->"7c5dcee5-2e75-4145-a94c-af181f1dbf93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "35.3569791730698`"}], ",", 
   RowBox[{"-", "43.56435291444238`"}], ",", 
   RowBox[{"-", "44.83234744291541`"}], ",", 
   RowBox[{"-", "43.11946976439369`"}], ",", 
   RowBox[{"-", "39.97439640222575`"}], ",", 
   RowBox[{"-", "36.834804831363435`"}], ",", 
   RowBox[{"-", "36.8474881666056`"}], ",", 
   RowBox[{"-", "31.16485783389022`"}], ",", 
   RowBox[{"-", "28.359327095317024`"}], ",", 
   RowBox[{"-", "31.315920237005294`"}], ",", 
   RowBox[{"-", "30.063332370624362`"}], ",", 
   RowBox[{"-", "27.161891002781818`"}], ",", 
   RowBox[{"-", "21.77099836415005`"}], ",", 
   RowBox[{"-", "25.633539240163568`"}], ",", 
   RowBox[{"-", "23.99546674740976`"}], ",", 
   RowBox[{"-", "24.993571862762487`"}], ",", 
   RowBox[{"-", "24.11483819550005`"}], ",", 
   RowBox[{"-", "23.098168529709618`"}], ",", 
   RowBox[{"-", "24.673222984620658`"}], ",", 
   RowBox[{"-", "24.592525677856845`"}], ",", 
   RowBox[{"-", "23.923167991693415`"}], ",", 
   RowBox[{"-", "28.062034469602224`"}], ",", 
   RowBox[{"-", "30.706540690122388`"}], ",", 
   RowBox[{"-", "27.787637047493153`"}], ",", 
   RowBox[{"-", "34.05778339154569`"}], ",", 
   RowBox[{"-", "33.451038775490346`"}], ",", 
   RowBox[{"-", "33.1597545959169`"}], ",", 
   RowBox[{"-", "31.840451801640214`"}], ",", 
   RowBox[{"-", "32.783650772614024`"}], ",", 
   RowBox[{"-", "32.046960557823766`"}], ",", 
   RowBox[{"-", "32.91209488154519`"}], ",", 
   RowBox[{"-", "33.60524206205513`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.899871175611281*^9, 3.9000121729769907`*^9, 3.90001487753209*^9, {
   3.9000152779655037`*^9, 3.9000152857337713`*^9}, 3.90019315782036*^9, 
   3.900194025349648*^9, 3.900194119606184*^9, {3.90019436373374*^9, 
   3.900194385771353*^9}, 3.9001944530978518`*^9, 3.904852007146968*^9, 
   3.904852147375918*^9, 3.90485779949049*^9, 3.905022748597465*^9, 
   3.9050228189716063`*^9, 3.9050232394652767`*^9, 3.905023350793971*^9, 
   3.905023421883727*^9, 3.905023463326867*^9, 3.90502355069947*^9, 
   3.9050251541955748`*^9, 3.905025281735693*^9, 3.9050254174228477`*^9, 
   3.905025659437492*^9, 3.905025828042693*^9},
 CellLabel->
  "Out[1256]=",ExpressionUUID->"ca62eacc-f763-4dd8-a18d-771ce006b7ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["newtab"], "Input",
 CellChangeTimes->{{3.899494900052326*^9, 3.8994949024508247`*^9}, {
   3.899869972968231*^9, 3.8998699927105017`*^9}, {3.899870044123687*^9, 
   3.8998700466845093`*^9}, 3.899871172195794*^9},
 CellLabel->
  "In[1257]:=",ExpressionUUID->"737f6a02-ec83-4d07-881c-5fa5038feb6a"],

Cell[BoxData[
 RowBox[{"-", "30.504318167011824`"}]], "Output",
 CellChangeTimes->{{3.8994949027722*^9, 3.89949492488351*^9}, 
   3.899496283028392*^9, 3.8994964141752872`*^9, 3.899752095820293*^9, 
   3.899752134540408*^9, {3.899752169375143*^9, 3.899752177314736*^9}, 
   3.8997553614528227`*^9, {3.899755954405478*^9, 3.899755973266117*^9}, 
   3.899756123953397*^9, {3.8997561973578*^9, 3.899756215545787*^9}, 
   3.899756613829196*^9, 3.899756722824489*^9, {3.899756847462522*^9, 
   3.899756868758431*^9}, 3.8998684624947157`*^9, 3.899868498489621*^9, 
   3.899868747003687*^9, {3.899869973953554*^9, 3.899869993371472*^9}, 
   3.89987004720408*^9, 3.899870098355385*^9, 3.9000121729792624`*^9, 
   3.900014877535321*^9, 3.9001931578400717`*^9, 3.900194025354341*^9, 
   3.9001941196112337`*^9, {3.9001943637773657`*^9, 3.9001943857771397`*^9}, 
   3.9001944531050987`*^9, 3.904857799495191*^9, 3.905022748613592*^9, 
   3.905022818984304*^9, 3.9050232394944572`*^9, 3.9050233507987633`*^9, 
   3.905023421911332*^9, 3.90502346335503*^9, 3.9050235507255507`*^9, 
   3.905025154219153*^9, 3.905025281759601*^9, 3.905025417446246*^9, 
   3.905025659461482*^9, 3.9050258280651617`*^9},
 CellLabel->
  "Out[1257]=",ExpressionUUID->"dde783b3-172a-4011-972e-588fcdfcada7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ptab", "=", 
    RowBox[{"Insert", "[", 
     RowBox[{"existtab", ",", "newtab", ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.8994949560353727`*^9, 3.899494960203659*^9}, {
  3.905023539873517*^9, 3.905023574000579*^9}},
 CellLabel->
  "In[1258]:=",ExpressionUUID->"a227ac53-361d-43c2-9dc4-23ef1ae41899"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mintab", "=", 
   RowBox[{"Min", "[", "ptab", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exptab", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"ptab", "-", "mintab"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"exptab", "/", 
    RowBox[{"Total", "[", "exptab", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", "mintab"}], "Input",
 CellChangeTimes->{{3.899494995540004*^9, 3.899495021351428*^9}, {
  3.905023180435402*^9, 3.905023182107484*^9}, {3.905023222550075*^9, 
  3.905023224011651*^9}, {3.905023280179965*^9, 3.905023343283618*^9}, {
  3.905023407302458*^9, 3.905023435732047*^9}, {3.9050235201703253`*^9, 
  3.905023521161146*^9}},
 CellLabel->
  "In[1259]:=",ExpressionUUID->"dce6a07f-aedf-4909-8532-cfdb397c9b13"],

Cell[BoxData[
 RowBox[{"-", "44.83234744291541`"}]], "Output",
 CellChangeTimes->{{3.905023436207199*^9, 3.905023463381217*^9}, {
   3.905023521546476*^9, 3.905023550749608*^9}, 3.905025154248498*^9, 
   3.905025281789031*^9, 3.90502541745457*^9, 3.905025659489175*^9, 
   3.905025828093728*^9},
 CellLabel->
  "Out[1262]=",ExpressionUUID->"7413d6b8-7b08-4041-bdeb-0ffed2018fed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"ptab", "+", "const"}], ",", "const"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"N", "[", 
    RowBox[{"ptab", "/", 
     RowBox[{"Total", "[", "ptab", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "ptab"}], "Input",
 CellChangeTimes->{{3.899494995540004*^9, 3.899495021351428*^9}, {
  3.905023180435402*^9, 3.905023182107484*^9}, {3.905023222550075*^9, 
  3.905023224011651*^9}, {3.905023280179965*^9, 3.905023343283618*^9}, {
  3.905023407302458*^9, 3.905023431498114*^9}},
 CellLabel->
  "In[1263]:=",ExpressionUUID->"44b1f873-4a57-4fa8-a727-7c05711ea466"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.100999975856599`*^-7", ",", "2.9999999897999997`*^-10", ",", 
   "1.9999999932`*^-10", ",", "3.9999999864`*^-10", ",", 
   "7.099999975859999`*^-9", ",", "1.6209999944886`*^-7", ",", 
   "1.59999999456`*^-7", ",", "0.00004697459984028636`", ",", 
   "0.0007767633973590044`", ",", "0.0000403884998626791`", ",", 
   "0.000141334699519462`", ",", "0.0025723414912540384`", ",", 
   "0.5643694905811437`", ",", "0.011859963259676124`", ",", 
   "0.06102238599252388`", ",", "0.022491459723529034`", ",", 
   "0.05415603041586949`", ",", "0.14968588479106798`", ",", 
   "0.030984421494652963`", ",", "0.033588436385799315`", ",", 
   "0.06559762797696805`", ",", "0.0010456859964446676`", ",", 
   "0.00007428609974742725`", ",", "0.0013758483953221154`", ",", 
   "2.60309999114946`*^-6", ",", "4.775199983764319`*^-6", ",", 
   "6.389899978274339`*^-6", ",", "0.000023903299918728776`", ",", 
   "9.3074999683545`*^-6", ",", "0.00001944339993389244`", ",", 
   "8.185599972168959`*^-6", ",", "4.09289998608414`*^-6", ",", 
   "0.00009093509969082066`"}], "}"}]], "Output",
 CellChangeTimes->{{3.899495001345262*^9, 3.899495026100705*^9}, 
   3.899496283080117*^9, 3.899496414252647*^9, 3.899752095900847*^9, 
   3.899752134630497*^9, {3.899752169458856*^9, 3.899752177413971*^9}, 
   3.8997553614726257`*^9, {3.8997559544254103`*^9, 3.899755973287745*^9}, 
   3.8997561239746304`*^9, {3.8997561973808002`*^9, 3.899756215565969*^9}, 
   3.899756613849102*^9, 3.899756722844799*^9, {3.899756847483449*^9, 
   3.899756868778468*^9}, 3.89986846253407*^9, 3.89986849858731*^9, 
   3.899868747028627*^9, 3.8998700983635073`*^9, 3.900012172998878*^9, 
   3.9000148775504713`*^9, 3.90019315786971*^9, 3.9001940253839703`*^9, 
   3.900194119650889*^9, {3.90019436381446*^9, 3.9001943858139973`*^9}, 
   3.900194453144059*^9, 3.904857799524301*^9, 3.9050227486362534`*^9, 
   3.905022819003023*^9, 3.905023182932844*^9, {3.905023224677409*^9, 
   3.905023239522399*^9}, {3.9050232825420628`*^9, 3.9050232945914593`*^9}, {
   3.9050233365604343`*^9, 3.9050233508365183`*^9}, {3.905023408946347*^9, 
   3.905023421938117*^9}, 3.905023463386754*^9, 3.905023550754746*^9, 
   3.905025154254373*^9, 3.905025281794264*^9, 3.90502541747841*^9, 
   3.9050256594943943`*^9, 3.90502582810043*^9},
 CellLabel->
  "Out[1265]=",ExpressionUUID->"317a7bbf-dd3e-4f5a-9d41-79ed9d43f379"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"newclass01", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"MultinomialDistribution", "[", 
         RowBox[{"1", ",", "ptab"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
     "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "Nc", "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.899495047864007*^9, 3.8994950530153646`*^9}, {
   3.89949509341357*^9, 3.899495094059387*^9}, {3.905023770679379*^9, 
   3.905023771637207*^9}, {3.9050239513475857`*^9, 3.9050239607267103`*^9}, 
   3.905025088309719*^9, {3.905025275879486*^9, 3.9050252765244703`*^9}},
 CellLabel->
  "In[1266]:=",ExpressionUUID->"13af66b3-844f-48e1-84a4-d9e3e5b498c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "4", ",", "15", ",", "21", ",", "35", ",", "38", ",", "36", ",", 
   "22", ",", "27", ",", "17", ",", "27", ",", "17", ",", "18", ",", "20", 
   ",", "16", ",", "19", ",", "24", ",", "25", ",", "13", ",", "9", ",", "20",
    ",", "13", ",", "11", ",", "8", ",", "13", ",", "7", ",", "6", ",", "4", 
   ",", "3", ",", "5", ",", "2", ",", "1", ",", "1", ",", "15"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9050252818212423`*^9, 3.905025417484067*^9, 
  3.905025659520262*^9, 3.9050258281260967`*^9},
 CellLabel->
  "Out[1267]=",ExpressionUUID->"0218e10b-8897-4586-8c82-3e3904c33d3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"newclass01", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"class01", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"newclass01", ",", 
        RowBox[{"{", 
         RowBox[{"-", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"class01", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nclass", "=", 
      RowBox[{"nclass", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"class01", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "class01", "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "samplesize", "}"}]}], "]"}], ",", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"class01", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", "newclass01"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"class", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "class01", "]"}], "*", 
        RowBox[{"Table", "[", 
         RowBox[{"c", ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "1", ",", "nclass"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Nc", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"Nc", ",", "0", ",", 
        RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ccf", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"Ccf", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nfield", "}"}]}], "]"}], ",", 
        RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fcf", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"Fcf", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nfield", "}"}]}], "]"}], ",", 
        RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ncf", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"Ncf", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nfield", "}"}]}], "]"}], ",", 
        RowBox[{"-", "2"}]}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nc", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Nc", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ccf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ccf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
    RowBox[{"Cif", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fcf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Fcf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
    RowBox[{"Fif", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ncf", "[", 
    RowBox[{"[", 
     RowBox[{"class", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ccf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
    RowBox[{"Fcf", "[", 
     RowBox[{"[", 
      RowBox[{"class", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", "Nc", "\[IndentingNewLine]", 
 RowBox[{"Total", "[", "Nc", "]"}]}], "Input",
 CellChangeTimes->{{3.905025147989912*^9, 3.9050251598798447`*^9}, {
  3.905025387582809*^9, 3.9050253911367207`*^9}, {3.9050254843489037`*^9, 
  3.905025488561124*^9}, {3.905025734733754*^9, 3.9050257390173388`*^9}, {
  3.9050258208609667`*^9, 3.90502582335553*^9}},
 CellLabel->
  "In[1268]:=",ExpressionUUID->"198345b3-184c-4db5-96d5-ac6ea7d3b294"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "4", ",", "15", ",", "21", ",", "35", ",", "38", ",", "36", ",", 
   "22", ",", "27", ",", "17", ",", "27", ",", "17", ",", "18", ",", "21", 
   ",", "16", ",", "19", ",", "24", ",", "25", ",", "13", ",", "9", ",", "20",
    ",", "13", ",", "11", ",", "8", ",", "13", ",", "7", ",", "6", ",", "4", 
   ",", "3", ",", "5", ",", "2", ",", "1", ",", "1", ",", "15"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.905025161400539*^9, 3.9050252818271837`*^9, {3.90502539174338*^9, 
   3.9050254174909267`*^9}, 3.905025488838305*^9, 3.905025659525648*^9, 
   3.905025739387947*^9, 3.905025828132142*^9},
 CellLabel->
  "Out[1273]=",ExpressionUUID->"4424eb39-62dd-4942-9f50-c0665a3172b4"],

Cell[BoxData["515"], "Output",
 CellChangeTimes->{
  3.905025161400539*^9, 3.9050252818271837`*^9, {3.90502539174338*^9, 
   3.9050254174909267`*^9}, 3.905025488838305*^9, 3.905025659525648*^9, 
   3.905025739387947*^9, 3.905025828133945*^9},
 CellLabel->
  "Out[1274]=",ExpressionUUID->"70db09b3-427d-4f47-aee5-90c5c077779e"]
}, Open  ]]
},
WindowSize->{1180, 1027},
WindowMargins->{{-1180, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (2023\:5e746\:67083\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4b31c00e-3d14-4f7b-9bf3-a2ba611d3d47"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 910, 24, 310, "Input",ExpressionUUID->"7f8cc05e-002f-473e-9648-4444ac58946a"],
Cell[CellGroupData[{
Cell[1515, 50, 1287, 20, 36, "Print",ExpressionUUID->"e586ba05-1762-4098-8591-712175e79b94"],
Cell[2805, 72, 2053, 42, 226, "Print",ExpressionUUID->"3fcb788c-0393-4981-9a50-7e8c80d2b571"],
Cell[4861, 116, 1289, 20, 36, "Print",ExpressionUUID->"881e9553-07a0-473e-865f-6205a8aa0ced"],
Cell[6153, 138, 5743, 105, 872, "Print",ExpressionUUID->"a5e0dc42-e880-41ef-8ead-562a1710dee8"]
}, Open  ]]
}, Open  ]],
Cell[11923, 247, 2056, 56, 422, "Input",ExpressionUUID->"4a26cfd6-e625-4a81-b0dd-3b35ed615a50"],
Cell[13982, 305, 3117, 93, 583, "Input",ExpressionUUID->"9b75d60d-e652-4522-8018-d54ab9256230"],
Cell[17102, 400, 2256, 64, 344, "Input",ExpressionUUID->"4a1d0910-2644-42d7-a327-ec67c2a9d80c"],
Cell[19361, 466, 1275, 37, 190, "Input",ExpressionUUID->"a8a0049b-4ad4-4a65-bc01-aa7b4dcb22be"],
Cell[20639, 505, 2728, 84, 337, "Input",ExpressionUUID->"5f1db319-317b-4f4e-aeb4-5f8b1b58bcf3"],
Cell[23370, 591, 6620, 173, 622, "Input",ExpressionUUID->"7e8393a0-72ba-4c71-8abb-8d85fcac0b93"],
Cell[CellGroupData[{
Cell[30015, 768, 383, 6, 46, "Input",ExpressionUUID->"7c5dcee5-2e75-4145-a94c-af181f1dbf93"],
Cell[30401, 776, 2266, 46, 167, "Output",ExpressionUUID->"ca62eacc-f763-4dd8-a18d-771ce006b7ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32704, 827, 310, 5, 46, "Input",ExpressionUUID->"737f6a02-ec83-4d07-881c-5fa5038feb6a"],
Cell[33017, 834, 1272, 19, 73, "Output",ExpressionUUID->"dde783b3-172a-4011-972e-588fcdfcada7"]
}, Open  ]],
Cell[34304, 856, 415, 11, 101, "Input",ExpressionUUID->"a227ac53-361d-43c2-9dc4-23ef1ae41899"],
Cell[CellGroupData[{
Cell[34744, 871, 814, 19, 209, "Input",ExpressionUUID->"dce6a07f-aedf-4909-8532-cfdb397c9b13"],
Cell[35561, 892, 379, 7, 73, "Output",ExpressionUUID->"7413d6b8-7b08-4041-bdeb-0ffed2018fed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35977, 904, 745, 19, 155, "Input",ExpressionUUID->"44b1f873-4a57-4fa8-a727-7c05711ea466"],
Cell[36725, 925, 2405, 38, 203, "Output",ExpressionUUID->"317a7bbf-dd3e-4f5a-9d41-79ed9d43f379"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39167, 968, 771, 17, 132, "Input",ExpressionUUID->"13af66b3-844f-48e1-84a4-d9e3e5b498c6"],
Cell[39941, 987, 636, 12, 105, "Output",ExpressionUUID->"0218e10b-8897-4586-8c82-3e3904c33d3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40614, 1004, 4752, 138, 769, "Input",ExpressionUUID->"198345b3-184c-4db5-96d5-ac6ea7d3b294"],
Cell[45369, 1144, 733, 14, 105, "Output",ExpressionUUID->"4424eb39-62dd-4942-9f50-c0665a3172b4"],
Cell[46105, 1160, 326, 6, 73, "Output",ExpressionUUID->"70db09b3-427d-4f47-aee5-90c5c077779e"]
}, Open  ]]
}
]
*)

