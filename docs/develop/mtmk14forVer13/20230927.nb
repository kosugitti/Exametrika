(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29945,        903]
NotebookOptionsPosition[     26391,        834]
NotebookOutlinePosition[     26798,        850]
CellTagsIndexPosition[     26755,        847]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"datafile", "=", "\"\<J5S10.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemlabelrow", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"studentIDcolumn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mi", "=", 
   RowBox[{"-", "99"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgefile", "=", "\"\<EdgesBNM.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"dir", "<>", "\"\<mod/Module_BNM.nb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemstat", "[", "data", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"adjmaking", "[", 
   RowBox[{"edgefile", ",", "\"\<BNM\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.904768181982973*^9, 3.904768221862068*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"8c716726-1293-4a8f-9230-d3df7f1e270a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Test Statistics\"\>"], "Print",
 CellChangeTimes->{3.9047682478543673`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[20]:=",ExpressionUUID->"978591f0-2746-4415-ab43-\
e0d5c0b15cd7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"N of Items\"\>", "5"},
     {"\<\"Sample Size\"\>", "10"},
     {"\<\"Mean\"\>", "2.6`"},
     {"\<\"SE of Mean\"\>", "0.47609522856952335`"},
     {"\<\"SD\"\>", "1.505545305418162`"},
     {"\<\"Skewness\"\>", 
      RowBox[{"-", "0.09884330004903598`"}]},
     {"\<\"Kurtosis\"\>", 
      RowBox[{"-", "0.7520184544405999`"}]},
     {"\<\"Min\"\>", "0"},
     {"\<\"Max\"\>", "5"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.904768247855669*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[20]:=",ExpressionUUID->"4138e964-b3f1-4d47-beef-\
e34e45ce3fec"],

Cell[BoxData["\<\"Item Statistics\"\>"], "Print",
 CellChangeTimes->{3.9047682478570633`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[20]:=",ExpressionUUID->"cf32f4e4-2839-46d3-b88c-\
b097d5534b83"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Item\"\>", "\<\"Number of Respondents\"\>", "\<\"Correct Response \
Rate\"\>", "\<\"Item Threshold\"\>", "\<\"Item-Total Correlation\"\>"},
     {"\<\"Item01\"\>", "10", "0.6`", 
      RowBox[{"-", "0.2533471031357998`"}], "0.5659453309702793`"},
     {"\<\"Item02\"\>", "10", "0.4`", "0.2533471031357998`", 
      "0.5916701187416554`"},
     {"\<\"Item03\"\>", "10", "0.9`", 
      RowBox[{"-", "1.2815515655446008`"}], "0.5461092327709237`"},
     {"\<\"Item04\"\>", "10", "0.3`", "0.5244005127080407`", 
      "0.7150248276820048`"},
     {"\<\"Item05\"\>", "10", "0.4`", "0.2533471031357998`", 
      "0.463046179884774`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.904768247858059*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[20]:=",ExpressionUUID->"09ee87fc-8b98-4f45-b596-\
fd164b648d72"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Constants", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maxnpa", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta1", "=", "1."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta0", "=", "1."}], ";"}]}]}]], "Input",
 CellChangeTimes->{3.904768265865437*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"72053119-23a1-45d7-9c48-d5a5e1c3450f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"npa", "=", 
   RowBox[{"Total", "[", "adj", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"adj", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "j"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxnpapos", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"npa", ",", 
      RowBox[{"Max", "[", "npa", "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "pa"}], "Input",
 CellChangeTimes->{{3.904768290330041*^9, 3.9047683060218687`*^9}, {
  3.9047683393195457`*^9, 3.904768349961714*^9}, {3.904768606429163*^9, 
  3.904768606530113*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"dcccd478-6949-49f4-ac01-9bad40cbdb4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.904768291943941*^9, 3.90476830630373*^9}, {
   3.9047683442388687`*^9, 3.904768350618191*^9}, 3.904768607131535*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"971b5bda-801e-4389-bece-e681fdc4eb82"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pir", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"npa", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uuu", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"pa", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "d"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", 
           RowBox[{"npa", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "samplesize", "}"}]}], "]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"J", " ", "x", " ", "Dj", " ", "x", " ", "S"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "pir", "]"}]}], "Input",
 CellChangeTimes->{{3.904768433498858*^9, 3.904768434460676*^9}, {
  3.904768474887719*^9, 3.904768494012074*^9}, {3.904768587743032*^9, 
  3.904768618414864*^9}, {3.9047687548601637`*^9, 3.9047687745548563`*^9}, {
  3.90476974027808*^9, 3.904769740579249*^9}, {3.904770286701868*^9, 
  3.904770291214407*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"45c454ef-f19f-4bd2-aa17-eaebb73fc71e"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}], "\<\"\"\>"},
    {GridBox[{
       {"0"},
       {"1"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"1"},
       {"1"},
       {"1"},
       {"1"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}], "\<\"\"\>"},
    {GridBox[{
       {"1"},
       {"0"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"1"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}], "\<\"\"\>"},
    {GridBox[{
       {"1"},
       {"0"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"1"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}], "\<\"\"\>"},
    {GridBox[{
       {"1"},
       {"1"},
       {"0"},
       {"1"},
       {"1"},
       {"1"},
       {"1"},
       {"1"},
       {"1"},
       {"1"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}], GridBox[{
       {"0"},
       {"1"},
       {"0"},
       {"1"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"0"},
       {"1"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  TableForm[{{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0}}, {{0, 1, 0, 1, 0, 0, 1, 1, 1, 
    1}}, {{1, 0, 0, 1, 0, 0, 1, 0, 0, 1}}, {{1, 0, 0, 1, 0, 0, 1, 0, 0, 
    1}}, {{1, 1, 0, 1, 1, 1, 1, 1, 1, 1}, {0, 1, 0, 1, 0, 0, 0, 0, 0, 
    1}}}]]], "Output",
 CellChangeTimes->{{3.904768487968199*^9, 3.904768494359185*^9}, {
   3.9047685963027163`*^9, 3.904768618817827*^9}, {3.90476876518592*^9, 
   3.904768775409566*^9}, 3.904769741138894*^9, 3.904770291634202*^9},
 CellLabel->
  "Out[103]//TableForm=",ExpressionUUID->"67b85a04-b0f7-451d-b044-\
78e48d2407cd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pirpmat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"pir", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "s", "]"}], "]"}], ",", "2"}], "]"}], "+", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "samplesize"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"S", " ", "x", " ", "J"}], "*)"}], ";"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"ec827e3c-5085-4f9d-97c0-7288d8095be7"],

Cell[CellGroupData[{

Cell[BoxData["pirpmat"], "Input",
 CellChangeTimes->{{3.904769748939809*^9, 3.904769754753652*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"7fae5a62-2349-4ae4-a98e-fd43910c9242"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "2", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "2", ",", "2", ",", "4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.904769750422904*^9, 3.904769755042824*^9}},
 CellLabel->
  "Out[101]=",ExpressionUUID->"acaa5a43-35b5-469c-97c8-23b5de8d0e1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pirparray", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "samplesize", "}"}], ",", 
     RowBox[{"{", "testlength", "}"}], ",", 
     RowBox[{"{", "itempatmax", "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"S", " ", "x", " ", "J", " ", "x", " ", "Dmax"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pirparray", "[", 
      RowBox[{"[", 
       RowBox[{"s", ",", "j", ",", 
        RowBox[{"pirpmat", "[", 
         RowBox[{"[", 
          RowBox[{"s", ",", "j"}], "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "1", ",", "samplesize"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pirparray", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9047750277918053`*^9, 3.904775058406674*^9}, {
  3.904775624226337*^9, 3.90477562842724*^9}, {3.904775774604838*^9, 
  3.9047758007545033`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"adb6ced7-6eb9-414a-83d3-0a0f93ee8e09"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.904775032946278*^9, 3.904775061250586*^9}, 
   3.904775628670483*^9, {3.904775779588133*^9, 3.904775801022482*^9}},
 CellLabel->
  "Out[125]=",ExpressionUUID->"7053a1c5-529e-46e5-90e7-0e4e1e35a602"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"npirp1", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"uuu", "*", "pirparray"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "npirp1", "]"}]}], "Input",
 CellChangeTimes->{{3.9047750859010477`*^9, 3.904775088681172*^9}, {
  3.90477540600667*^9, 3.904775413799819*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"22703e5b-314f-455d-843f-d847d5331e43"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"6", "0", "0", "0"},
     {"1", "3", "0", "0"},
     {"5", "4", "0", "0"},
     {"1", "2", "0", "0"},
     {"0", "0", "2", "2"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9047750891375713`*^9, 3.9047754140750303`*^9},
 CellLabel->
  "Out[113]//MatrixForm=",ExpressionUUID->"12feae5e-4436-410d-b5c4-\
6b6ab2e7e4cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"npirp1", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"uuu", "*", "pirparray"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npirp0", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"zzz", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "uuu"}], ")"}], "*", "pirparray"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"denomnpirp", "=", 
    RowBox[{"npirp1", "+", "npirp0", "+", "beta0", "+", "beta1", "-", "2"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "npirp1", "]"}], ",", 
       RowBox[{"MatrixForm", "[", "npirp0", "]"}]}], "}"}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denom0", "=", 
   RowBox[{"Sign", "[", 
    RowBox[{"npirp1", "+", "npirp0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denomnpirp", "=", 
   RowBox[{"denomnpirp", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "denom0"}], ")"}], "*", "100"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"npirp1", "+", "beta1", "-", "1"}], ")"}], "/", "denomnpirp"}]}],
   ";"}], "\[IndentingNewLine]", "denom0"}], "Input",
 CellChangeTimes->{{3.9047764334939537`*^9, 3.904776458627962*^9}, {
  3.904776668866637*^9, 3.904776703369082*^9}, {3.9047772143512983`*^9, 
  3.904777218810378*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"e42cc794-2852-4d1e-abc4-47287cd3c45f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.904776703835643*^9, 3.904777219111885*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"74be5bda-5e7b-40d0-8d6d-0644f4987386"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{
    RowBox[{"param", "*", "denom0"}], "-", "1", "+", "denom0"}]}], 
  ";"}], "\[IndentingNewLine]", "param"}], "Input",
 CellChangeTimes->{{3.90477670878354*^9, 3.904776714818585*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"4ea3b66e-2505-4625-93df-c8a4c95e2a75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25`", ",", "0.5`", ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8333333333333333`", ",", "1.`", ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16666666666666663`", ",", "0.5`", ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "1.`"}], ",", "0.33333333333333326`", ",", 
     "0.6666666666666666`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.904776715230668*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"6989c686-ce28-4b60-b1a4-d7a574f4e005"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"estparam01", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"2", "^", 
           RowBox[{"npa", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "itempatmax"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "estparam01"}], "Input",
 CellChangeTimes->{
  3.904776748208487*^9, {3.904776848069812*^9, 3.904776852509392*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"3a5231d4-fddf-4228-a924-326df97147ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9047768529093103`*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"efc9d68c-18ea-42da-9f64-9be70147871f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{"param", "-", 
    RowBox[{"8", 
     RowBox[{"(", 
      RowBox[{"1", "-", "estparam01"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", "param"}], "Input",
 CellChangeTimes->{
  3.904776748208487*^9, {3.904776848069812*^9, 3.904776876395713*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"30e56508-f352-43d0-bd9b-ee4770ad55b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}], ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}], ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25`", ",", "0.5`", ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}], ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8333333333333333`", ",", "1.`", ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}], ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16666666666666663`", ",", "0.5`", ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}], ",", 
     RowBox[{
      RowBox[{"-", "16"}], "+", "\<\"\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "\<\"NaN(0/0)\"\>", ",", "0.33333333333333326`", ",", 
     "0.6666666666666666`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.904776872120886*^9, 3.90477687678191*^9}},
 CellLabel->
  "Out[178]=",ExpressionUUID->"2b20ca3b-590c-4326-9e8c-8ef1b6ef43be"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{"param", "/.", 
    RowBox[{
     RowBox[{"-", "9."}], "\[Rule]", "\"\<\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{"param", "/.", 
    RowBox[{
     RowBox[{"-", "1."}], "\[Rule]", "\"\<NaN(0/0)\>\""}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramout", "=", 
   RowBox[{"PadLeft", "[", 
    RowBox[{"param", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"testlength", "+", "1"}], ",", 
       RowBox[{"itempatmax", "+", "1"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{
  3.904776748208487*^9, {3.904776848069812*^9, 
   3.9047768679640293`*^9}},ExpressionUUID->"020e1f71-f19f-47b7-a72e-\
3ac3fd1db68e"],

Cell[CellGroupData[{

Cell[BoxData["paramout"], "Input",
 CellChangeTimes->{{3.9047767571709003`*^9, 3.90477675883213*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"d1720ad3-ab67-4d13-b5e9-93bf2656f22e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.6000000000000001`", ",", "\<\"\"\>", ",", "\<\"\"\>", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.25`", ",", "0.5`", ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.8333333333333333`", ",", "1.`", ",", "\<\"\"\>", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.16666666666666663`", ",", "0.5`", ",", "\<\"\"\>", 
     ",", "\<\"\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.`", ",", "\<\"NaN(0/0)\"\>", ",", "0.33333333333333326`", 
     ",", "0.6666666666666666`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.904776759125016*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"f74211b9-4c75-42bf-b714-9d77f7c49301"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"con", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", "testlength"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"dir", "<>", "\"\<mod/Module_Modelfit.nb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelloglike", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"npirp1", "*", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{"param", "*", "denom0"}], "+", "con"}], "]"}]}], "+", 
      RowBox[{"npirp0", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"param", "*", "denom0"}], "+", "con"}], "]"}]}]}], ",", 
     "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelnparam", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"denom0", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "modelnparam"}], "Input",
 CellChangeTimes->{{3.904776711186551*^9, 3.904776712377473*^9}, {
  3.90477729690667*^9, 3.904777316680229*^9}, {3.9047773961383953`*^9, 
  3.904777399962788*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"3cad48ea-b83a-4dae-994d-a7508ae8c80a"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.904777317215334*^9, 3.904777401026815*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"49534776-7c38-4e1c-a5d1-0783a2467d52"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{-981, Automatic}, {114, Automatic}},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (2023\:5e746\:67083\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b948caf3-3a4c-4bbb-ab4a-bc6bc688477d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 934, 24, 193, "Input",ExpressionUUID->"8c716726-1293-4a8f-9230-d3df7f1e270a"],
Cell[CellGroupData[{
Cell[1539, 50, 201, 4, 24, "Print",ExpressionUUID->"978591f0-2746-4415-ab43-e0d5c0b15cd7"],
Cell[1743, 56, 993, 28, 158, "Print",ExpressionUUID->"4138e964-b3f1-4d47-beef-e34e45ce3fec"],
Cell[2739, 86, 201, 4, 24, "Print",ExpressionUUID->"cf32f4e4-2839-46d3-b88c-b097d5534b83"],
Cell[2943, 92, 1237, 29, 108, "Print",ExpressionUUID->"09ee87fc-8b98-4f45-b596-fd164b648d72"]
}, Open  ]]
}, Open  ]],
Cell[4207, 125, 437, 11, 94, "Input",ExpressionUUID->"72053119-23a1-45d7-9c48-d5a5e1c3450f"],
Cell[CellGroupData[{
Cell[4669, 140, 1053, 30, 139, "Input",ExpressionUUID->"dcccd478-6949-49f4-ac01-9bad40cbdb4c"],
Cell[5725, 172, 461, 11, 34, "Output",ExpressionUUID->"971b5bda-801e-4389-bece-e681fdc4eb82"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6223, 188, 1466, 38, 116, "Input",ExpressionUUID->"45c454ef-f19f-4bd2-aa17-eaebb73fc71e"],
Cell[7692, 228, 3786, 139, 703, "Output",ExpressionUUID->"67b85a04-b0f7-451d-b044-78e48d2407cd"]
}, Open  ]],
Cell[11493, 370, 700, 19, 67, "Input",ExpressionUUID->"ec827e3c-5085-4f9d-97c0-7288d8095be7"],
Cell[CellGroupData[{
Cell[12218, 393, 182, 3, 30, "Input",ExpressionUUID->"7fae5a62-2349-4ae4-a98e-fd43910c9242"],
Cell[12403, 398, 1095, 26, 56, "Output",ExpressionUUID->"acaa5a43-35b5-469c-97c8-23b5de8d0e1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13535, 429, 1172, 33, 103, "Input",ExpressionUUID->"adb6ced7-6eb9-414a-83d3-0a0f93ee8e09"],
Cell[14710, 464, 669, 16, 34, "Output",ExpressionUUID->"7053a1c5-529e-46e5-90e7-0e4e1e35a602"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15416, 485, 413, 10, 80, "Input",ExpressionUUID->"22703e5b-314f-455d-843f-d847d5331e43"],
Cell[15832, 497, 748, 22, 113, "Output",ExpressionUUID->"12feae5e-4436-410d-b5c4-6b6ab2e7e4cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16617, 524, 1582, 48, 223, "Input",ExpressionUUID->"e42cc794-2852-4d1e-abc4-47287cd3c45f"],
Cell[18202, 574, 595, 15, 34, "Output",ExpressionUUID->"74be5bda-5e7b-40d0-8d6d-0644f4987386"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18834, 594, 329, 8, 52, "Input",ExpressionUUID->"4ea3b66e-2505-4625-93df-c8a4c95e2a75"],
Cell[19166, 604, 915, 26, 56, "Output",ExpressionUUID->"6989c686-ce28-4b60-b1a4-d7a574f4e005"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20118, 635, 703, 20, 67, "Input",ExpressionUUID->"3a5231d4-fddf-4228-a924-326df97147ea"],
Cell[20824, 657, 575, 15, 34, "Output",ExpressionUUID->"efc9d68c-18ea-42da-9f64-9be70147871f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21436, 677, 392, 11, 52, "Input",ExpressionUUID->"30e56508-f352-43d0-bd9b-ee4770ad55b2"],
Cell[21831, 690, 1232, 35, 56, "Output",ExpressionUUID->"2b20ca3b-590c-4326-9e8c-8ef1b6ef43be"]
}, Open  ]],
Cell[23078, 728, 759, 25, 86, "Input",ExpressionUUID->"020e1f71-f19f-47b7-a72e-3ac3fd1db68e"],
Cell[CellGroupData[{
Cell[23862, 757, 184, 3, 30, "Input",ExpressionUUID->"d1720ad3-ab67-4d13-b5e9-93bf2656f22e"],
Cell[24049, 762, 949, 27, 56, "Output",ExpressionUUID->"f74211b9-4c75-42bf-b714-9d77f7c49301"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25035, 794, 1161, 32, 196, "Input",ExpressionUUID->"3cad48ea-b83a-4dae-994d-a7508ae8c80a"],
Cell[26199, 828, 176, 3, 82, "Output",ExpressionUUID->"49534776-7c38-4e1c-a5d1-0783a2467d52"]
}, Open  ]]
}
]
*)

