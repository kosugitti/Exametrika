(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68772,       1608]
NotebookOptionsPosition[     64636,       1531]
NotebookOutlinePosition[     65074,       1548]
CellTagsIndexPosition[     65031,       1545]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"datafile", "=", "\"\<J35S515.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemlabelrow", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"studentIDcolumn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mi", "=", 
   RowBox[{"-", "99"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minclssize", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"dir", "<>", "\"\<mod/Module_CTT.nb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemstat", "[", "data", "]"}], ";"}]}], "Input",
 CellLabel->
  "In[579]:=",ExpressionUUID->"68227bcb-33ce-4816-81d0-586ac14db2e2"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Test Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.9051996680591183`*^9, 3.90519991530184*^9, 3.905199974115926*^9, {
   3.905200834791363*^9, 3.90520085666556*^9}, 3.9052012094764843`*^9, 
   3.905202327713044*^9, 3.905203873140442*^9, 3.905209368734708*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"6dc0dc77-0c7d-46d3-a8ea-\
a16080cf3ff2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"N of Items\"\>", "35"},
     {"\<\"Sample Size\"\>", "515"},
     {"\<\"Mean\"\>", "12.749514563106796`"},
     {"\<\"SE of Mean\"\>", "0.3567865140306771`"},
     {"\<\"SD\"\>", "8.096774514953083`"},
     {"\<\"Skewness\"\>", "0.7703382465193783`"},
     {"\<\"Kurtosis\"\>", "0.0359465678636659`"},
     {"\<\"Min\"\>", "0"},
     {"\<\"Max\"\>", "35"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.9051996680591183`*^9, 3.90519991530184*^9, 3.905199974115926*^9, {
   3.905200834791363*^9, 3.90520085666556*^9}, 3.9052012094764843`*^9, 
   3.905202327713044*^9, 3.905203873140442*^9, 3.905209368735856*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"060d0abd-e13b-4ee2-9ce0-\
c4963ca6d765"],

Cell[BoxData["\<\"Item Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.9051996680591183`*^9, 3.90519991530184*^9, 3.905199974115926*^9, {
   3.905200834791363*^9, 3.90520085666556*^9}, 3.9052012094764843`*^9, 
   3.905202327713044*^9, 3.905203873140442*^9, 3.905209368737649*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"801561e6-a950-400f-af21-\
772c13b93d47"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Item\"\>", "\<\"Number of Respondents\"\>", "\<\"Correct Response \
Rate\"\>", "\<\"Item Threshold\"\>", "\<\"Item-Total Correlation\"\>"},
     {"\<\"Item01\"\>", "515", "0.8504854368932039`", 
      RowBox[{"-", "1.038517641955578`"}], "0.3713495176934055`"},
     {"\<\"Item02\"\>", "515", "0.39223300970873787`", "0.2735037378950026`", 
      "0.6656857153200353`"},
     {"\<\"Item03\"\>", "515", "0.458252427184466`", "0.10483737262774764`", 
      "0.5424516101473047`"},
     {"\<\"Item04\"\>", "515", "0.3029126213592233`", "0.5160417605007561`", 
      "0.6392543201065256`"},
     {"\<\"Item05\"\>", "515", "0.2504854368932039`", "0.6729629316411024`", 
      "0.6122765729913002`"},
     {"\<\"Item06\"\>", "515", "0.21553398058252426`", "0.7873654581038404`", 
      "0.611676651387653`"},
     {"\<\"Item07\"\>", "515", "0.5728155339805825`", 
      RowBox[{"-", "0.18354688834314817`"}], "0.40097552917337825`"},
     {"\<\"Item08\"\>", "515", "0.34951456310679613`", "0.386631376099102`", 
      "0.34976069503275703`"},
     {"\<\"Item09\"\>", "515", "0.39029126213592236`", "0.2785599858125778`", 
      "0.4711715165784889`"},
     {"\<\"Item10\"\>", "515", "0.3533980582524272`", "0.376162467273338`", 
      "0.47492802963027025`"},
     {"\<\"Item11\"\>", "515", "0.47572815533980584`", "0.06087807498546322`",
       "0.7250558590768102`"},
     {"\<\"Item12\"\>", "515", "0.33980582524271846`", "0.41299312538917526`",
       "0.6281614727335694`"},
     {"\<\"Item13\"\>", "515", "0.23689320388349513`", "0.7163319422655497`", 
      "0.5677541174939663`"},
     {"\<\"Item14\"\>", "515", "0.1262135922330097`", "1.1444738312523375`", 
      "0.6091023364528331`"},
     {"\<\"Item15\"\>", "515", "0.08737864077669903`", "1.3570753132816924`", 
      "0.5593391821716797`"},
     {"\<\"Item16\"\>", "515", "0.21553398058252426`", "0.7873654581038404`", 
      "0.6070153872334288`"},
     {"\<\"Item17\"\>", "515", "0.2757281553398058`", "0.5955792968709146`", 
      "0.5257090351255301`"},
     {"\<\"Item18\"\>", "515", "0.04854368932038835`", "1.6591410224234104`", 
      "0.4127690804300786`"},
     {"\<\"Item19\"\>", "515", "0.05242718446601942`", "1.6217617612083302`", 
      "0.41573744931877876`"},
     {"\<\"Item20\"\>", "515", "0.05436893203883495`", "1.603891983892223`", 
      "0.4268923577811534`"},
     {"\<\"Item21\"\>", "515", "0.6155339805825243`", 
      RowBox[{"-", "0.29377212223106125`"}], "0.6877248571783768`"},
     {"\<\"Item22\"\>", "515", "0.5864077669902913`", 
      RowBox[{"-", "0.21831400139733484`"}], "0.6896688457112237`"},
     {"\<\"Item23\"\>", "515", "0.6`", 
      RowBox[{"-", "0.2533471031357998`"}], "0.6100406707370244`"},
     {"\<\"Item24\"\>", "515", "0.566990291262136`", 
      RowBox[{"-", "0.16871678252646105`"}], "0.6542825476761968`"},
     {"\<\"Item25\"\>", "515", "0.4912621359223301`", "0.021904328645649434`",
       "0.7195211128578042`"},
     {"\<\"Item26\"\>", "515", "0.4524271844660194`", "0.1195313947295636`", 
      "0.7429019527247144`"},
     {"\<\"Item27\"\>", "515", "0.41359223300970877`", "0.21831400139733456`",
       "0.6841748312819268`"},
     {"\<\"Item28\"\>", "515", "0.22135922330097088`", "0.7676107958854407`", 
      "0.677820612725525`"},
     {"\<\"Item29\"\>", "515", "0.22718446601941747`", "0.7481512500500589`", 
      "0.5851096914681957`"},
     {"\<\"Item30\"\>", "515", "0.0854368932038835`", "1.3694015615706736`", 
      "0.4414223809905667`"},
     {"\<\"Item31\"\>", "515", "0.8116504854368932`", 
      RowBox[{"-", "0.8839947829217846`"}], "0.34909235005893596`"},
     {"\<\"Item32\"\>", "515", "0.8077669902912621`", 
      RowBox[{"-", "0.8696969867177557`"}], "0.26034561653662286`"},
     {"\<\"Item33\"\>", "515", "0.4368932038834951`", "0.15885082097374867`", 
      "0.3837006938909515`"},
     {"\<\"Item34\"\>", "515", "0.229126213592233`", "0.7417275452057569`", 
      "0.2859237182345218`"},
     {"\<\"Item35\"\>", "515", "0.1553398058252427`", "1.013797032381492`", 
      "0.3472703507353228`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.9051996680591183`*^9, 3.90519991530184*^9, 3.905199974115926*^9, {
   3.905200834791363*^9, 3.90520085666556*^9}, 3.9052012094764843`*^9, 
   3.905202327713044*^9, 3.905203873140442*^9, 3.9052093687601423`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"d05c3d2c-3881-402d-b2d7-\
4dade48a8b64"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samefieldcount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxsamefieldcount", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"const", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamc", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamf", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxt", "=", "50"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximum", " ", "number", " ", "of", " ", "iterations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nrightpat", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", "totalscore", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerogroup", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nrightpat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", "1", ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullgroup", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nrightpat", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", "testlength"}], ",", 
     "1", ",", "0"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[587]:=",ExpressionUUID->"a7133a94-e163-429c-91fe-7ebe62a287ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nclass", "=", 
    RowBox[{"Length", "[", "nrightpat", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "initial", " ", "value", " ", "for", " ", "the", " ", "number",
     " ", "of", " ", "classes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class01", "=", 
   RowBox[{"1", "-", 
    RowBox[{"Sign", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{"totalscore", "-", 
       RowBox[{"Table", "[", 
        RowBox[{"nrightpat", ",", 
         RowBox[{"{", "samplesize", "}"}]}], "]"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class", "=", 
   RowBox[{"class01", ".", 
    RowBox[{"Table", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "1", ",", "nclass"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nc", "=", 
   RowBox[{"Total", "[", "class01", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nfield", "=", "testlength"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "initial", " ", "value", " ", "for", " ", "the", " ", "number",
     " ", "of", " ", "fields"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemnum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"j", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"field", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"crr", ",", "itemnum"}], "}"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "itemnum"}], "}"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"field01", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "testlength", "}"}], ",", 
     RowBox[{"{", "nfield", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"field01", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", 
        RowBox[{"field", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.905202563731551*^9, 3.9052025698903103`*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"f478c19d-96bc-49b4-acbd-648638abd50c"],

Cell[CellGroupData[{

Cell[BoxData[{"field", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nf", "=", 
   RowBox[{"Total", "[", "field01", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.905202563731551*^9, 3.9052025944465933`*^9}, {
  3.905202638468698*^9, 3.905202696898802*^9}, {3.905202812143001*^9, 
  3.905202812979062*^9}},
 CellLabel->
  "In[607]:=",ExpressionUUID->"194ff1b1-4a7e-4934-94d5-5ef3815f6f00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "15", ",", "11", ",", "20", ",", "22", ",", "28", ",", "7", ",", 
   "18", ",", "16", ",", "17", ",", "10", ",", "19", ",", "23", ",", "30", 
   ",", "31", ",", "27", ",", "21", ",", "35", ",", "34", ",", "33", ",", "4",
    ",", "6", ",", "5", ",", "8", ",", "9", ",", "12", ",", "14", ",", "26", 
   ",", "25", ",", "32", ",", "2", ",", "3", ",", "13", ",", "24", ",", 
   "29"}], "}"}]], "Output",
 CellChangeTimes->{{3.905202594826934*^9, 3.9052026974389143`*^9}, 
   3.905202813340765*^9, 3.9052038732060957`*^9, 3.9052093688216*^9},
 CellLabel->
  "Out[607]=",ExpressionUUID->"009977ec-d4b5-43d9-b2bf-35dab0572cd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ccf", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "class01", "]"}], ".", "uuu", ".", 
    "field01"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fcf", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "class01", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"zzz", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "uuu"}], ")"}]}], ")"}], ".", "field01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ncf", "=", 
   RowBox[{"Ccf", "+", "Fcf"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pcf", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Ccf", "+", "gamp", "-", "1"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"Ncf", "+", 
       RowBox[{"2", "gamp"}], "-", "2"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"zerogroup", "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{"Pcf", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "nfield", "}"}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"fullgroup", "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{"Pcf", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", "nfield", "}"}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "Ncf"}], "Input",
 CellChangeTimes->{{3.905211084346158*^9, 3.905211086212347*^9}},
 CellLabel->
  "In[650]:=",ExpressionUUID->"129186ae-e44c-4e72-afb7-c91543af309a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2",
      ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "4", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4",
      ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "8", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", 
     "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", 
     "30", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", 
     ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", 
     "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", 
     ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", 
     "42", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", ",", "21", 
     ",", "21"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", 
     ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", 
     "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", 
     ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", 
     "70", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", 
     ",", "35"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", 
     ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", 
     "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", 
     ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", 
     "76", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", ",", "38", 
     ",", "38"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", 
     ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", 
     "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", 
     ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", 
     "72", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", ",", "36", 
     ",", "36"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", 
     ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", 
     "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", 
     ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", 
     "44", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", ",", "22", 
     ",", "22"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", 
     "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", 
     "54", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", 
     "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", 
     "34", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", 
     "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", 
     "54", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", ",", "27", 
     ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", 
     "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", 
     "34", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", ",", "17", 
     ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", 
     ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", 
     "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", 
     ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", 
     "36", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "18", 
     ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "40", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", 
     ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", 
     "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", 
     ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", 
     "32", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", ",", "16", 
     ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "40", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", 
     ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", 
     "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", 
     ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", 
     "48", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", ",", "24", 
     ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", 
     ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", 
     "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", 
     ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", 
     "50", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", ",", "25", 
     ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "26", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9",
      ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", 
     ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", 
     ",", "9", ",", "9", ",", "9", ",", "9", ",", "18", ",", "9", ",", "9", 
     ",", "9", ",", "9", ",", "9", ",", "9", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", 
     "40", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", ",", "20", 
     ",", "20"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "26", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", 
     ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", 
     "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", 
     ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", 
     "22", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", ",", "11", 
     ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8",
      ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", 
     ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", 
     ",", "8", ",", "8", ",", "8", ",", "8", ",", "16", ",", "8", ",", "8", 
     ",", "8", ",", "8", ",", "8", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", 
     "26", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", ",", "13", 
     ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7",
      ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", 
     ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", 
     ",", "7", ",", "7", ",", "7", ",", "7", ",", "14", ",", "7", ",", "7", 
     ",", "7", ",", "7", ",", "7", ",", "7", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6",
      ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", 
     ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", 
     ",", "6", ",", "6", ",", "6", ",", "6", ",", "12", ",", "6", ",", "6", 
     ",", "6", ",", "6", ",", "6", ",", "6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4",
      ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "8", ",", "4", ",", "4", 
     ",", "4", ",", "4", ",", "4", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3",
      ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", 
     ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", 
     ",", "3", ",", "3", ",", "3", ",", "3", ",", "6", ",", "3", ",", "3", 
     ",", "3", ",", "3", ",", "3", ",", "3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5",
      ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", 
     ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", 
     ",", "5", ",", "5", ",", "5", ",", "5", ",", "10", ",", "5", ",", "5", 
     ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2",
      ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "4", ",", "2", ",", "2", 
     ",", "2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", 
     ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", 
     "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", 
     "30", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", ",", "15", 
     ",", "15"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.905211086725265*^9},
 CellLabel->
  "Out[656]=",ExpressionUUID->"bfbb6bbb-b994-45e3-a6b8-4e3c645a5b3e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jrand", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Random", "[", "]"}], ",", 
          RowBox[{"{", "testlength", "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"j", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "testlength"}], "}"}]}], "]"}]}], 
       "}"}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rj", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", 
   RowBox[{"jrand", "[", 
    RowBox[{"[", "rj", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oldfield", "=", "field"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cjc", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "uuu", "]"}], ".", "class01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fjc", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"zzz", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "uuu"}], ")"}]}], "]"}], ".", "class01"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.905199712130862*^9, 3.905199752573142*^9}, {
  3.905199801926499*^9, 3.9051998142329082`*^9}, {3.905199897883127*^9, 
  3.905199898247366*^9}},
 CellLabel->
  "In[615]:=",ExpressionUUID->"5a3deebe-08db-4740-9e46-b2569d85c364"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Nf", "[", 
    RowBox[{"[", 
     RowBox[{"field", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Nf", "[", 
     RowBox[{"[", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ncf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ncf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "-", "Nc"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ccf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ccf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "-", 
    RowBox[{"Cjc", "[", 
     RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fcf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Fcf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "-", 
    RowBox[{"Fjc", "[", 
     RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ccfplus", "=", 
   RowBox[{"Ccf", "+", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Cjc", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", "nfield", "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fcfplus", "=", 
   RowBox[{"Fcf", "+", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Fjc", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", "nfield", "}"}]}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.905199712130862*^9, 3.905199722055461*^9}, {
   3.905199855534923*^9, 3.905199856202485*^9}, 3.905199949191101*^9, {
   3.905199996973155*^9, 3.905200010355136*^9}},
 CellLabel->
  "In[622]:=",ExpressionUUID->"5e993d7b-753b-40c8-b2b8-ce8dd3059d06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nf", "[", 
      RowBox[{"[", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nfield", "=", 
      RowBox[{"nfield", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"delf", "=", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"field01", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"field01", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"field", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "field01", "]"}], "*", 
        RowBox[{"Table", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", "nfield"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Nf", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Nf", ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ncf", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Ncf", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ccf", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Ccf", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fcf", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Fcf", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ccfplus", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Ccfplus", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fcfplus", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Fcfplus", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "delf", "}"}]}], "]"}]}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.905199712130862*^9, 3.905199722055461*^9}, {
   3.905199855534923*^9, 3.905199856202485*^9}, 3.905199949191101*^9, {
   3.905199996973155*^9, 3.90520004142673*^9}, {3.905200277699533*^9, 
   3.905200299633944*^9}, {3.9052006494417353`*^9, 3.90520065413122*^9}, {
   3.9052008216822433`*^9, 3.9052008522746677`*^9}, 3.905202323160048*^9},
 CellLabel->
  "In[628]:=",ExpressionUUID->"144d9d89-fd3e-499c-8678-5ef8db9c23ae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"logtab", "=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"Nf", "/", 
        RowBox[{"(", 
         RowBox[{"testlength", "-", "1", "+", "gamf"}], ")"}]}], "]"}], "+", 
      "const"}], "]"}], "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Ccfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", "1", 
              "-", "s", "+", "const"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Ccfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
              RowBox[{"Ccf", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Fcfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", "gamp", "-", "1", 
              "-", "s", "+", "const"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Fcfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
              RowBox[{"Fcf", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"Ccfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
              RowBox[{"Fcfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
              RowBox[{"2", "gamp"}], "-", "1", "-", "s", "+", "const"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", 
             RowBox[{
              RowBox[{"Ccfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "+", 
              RowBox[{"Fcfplus", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
              RowBox[{"Ccf", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", 
              RowBox[{"Fcf", "[", 
               RowBox[{"[", 
                RowBox[{"c", ",", "f"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "1", ",", "nclass"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", "1", ",", "nfield"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", "logtab"}], "Input",
 CellChangeTimes->{{3.905199712130862*^9, 3.905199722055461*^9}, {
   3.905199855534923*^9, 3.905199856202485*^9}, 3.905199949191101*^9, 
   3.905199996973155*^9, 3.905200853605403*^9, {3.905200884801319*^9, 
   3.905200932995227*^9}, {3.905201016374036*^9, 3.905201051303196*^9}, {
   3.905201422031419*^9, 3.905201428728355*^9}, {3.90520159215958*^9, 
   3.905201596956863*^9}, {3.9052018076934566`*^9, 3.905201908594133*^9}, {
   3.9052020368903513`*^9, 3.905202043596936*^9}, {3.905202447607561*^9, 
   3.905202447724758*^9}, {3.9052038684769087`*^9, 3.905203882110276*^9}, 
   3.9052039850669394`*^9, {3.905204145404792*^9, 3.905204148118804*^9}},
 CellLabel->
  "In[629]:=",ExpressionUUID->"f63983b6-3843-4b82-a04b-360360102924"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "447.9140205072813`"}], ",", 
   RowBox[{"-", "415.67046513173267`"}], ",", 
   RowBox[{"-", "407.7191488510756`"}], ",", 
   RowBox[{"-", "315.499076256511`"}], ",", 
   RowBox[{"-", "302.56806385388387`"}], ",", 
   RowBox[{"-", "292.6525968137039`"}], ",", 
   RowBox[{"-", "279.824019057742`"}], ",", 
   RowBox[{"-", "287.5221796843942`"}], ",", 
   RowBox[{"-", "255.8986324913615`"}], ",", 
   RowBox[{"-", "246.52414525767276`"}], ",", 
   RowBox[{"-", "231.94641059946437`"}], ",", 
   RowBox[{"-", "250.82806643395278`"}], ",", 
   RowBox[{"-", "238.4790188616924`"}], ",", 
   RowBox[{"-", "224.11442539862296`"}], ",", 
   RowBox[{"-", "210.04918969749127`"}], ",", 
   RowBox[{"-", "225.18231185609423`"}], ",", 
   RowBox[{"-", "212.18825208483506`"}], ",", 
   RowBox[{"-", "228.03694693783467`"}], ",", 
   RowBox[{"-", "205.9650940953554`"}], ",", 
   RowBox[{"-", "194.82028029610242`"}], ",", 
   RowBox[{"-", "202.9840221881741`"}], ",", 
   RowBox[{"-", "200.07366620425162`"}], ",", 
   RowBox[{"-", "227.36079628003915`"}], ",", 
   RowBox[{"-", "193.26946947841745`"}], ",", 
   RowBox[{"-", "191.68353670143821`"}], ",", 
   RowBox[{"-", "199.9018346716664`"}], ",", 
   RowBox[{"-", "184.6175684274125`"}], ",", 
   RowBox[{"-", "223.78962673620072`"}], ",", 
   RowBox[{"-", "212.9366120259205`"}], ",", 
   RowBox[{"-", "225.3409770715692`"}], ",", 
   RowBox[{"-", "238.45051850669233`"}], ",", 
   RowBox[{"-", "251.73001869386601`"}], ",", 
   RowBox[{"-", "253.80070491394605`"}], ",", 
   RowBox[{"-", "256.1171604289274`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9052038825222807`*^9, 3.905203987278653*^9, 
  3.905204148528227*^9, 3.9052093689378643`*^9},
 CellLabel->
  "Out[630]=",ExpressionUUID->"9dba9fd5-c1b3-4e8e-99af-30e17839777c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"minlog", "=", 
   RowBox[{"Min", "[", "logtab", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exptab", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"logtab", "-", "minlog"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "exptab"}], "Input",
 CellChangeTimes->{{3.905204184514991*^9, 3.905204240867041*^9}, {
   3.905204280768991*^9, 3.90520431138422*^9}, 3.9052043803257923`*^9, 
   3.905206789114182*^9, {3.90520873778922*^9, 3.905208743176857*^9}},
 CellLabel->
  "In[631]:=",ExpressionUUID->"7dd7bf9b-e936-4fdb-b471-1a35d42c9a49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.0073912551033662`*^14", ",", "2.8602958836633286`*^17", ",", 
   "3.2142496821990155`*^57", ",", "1.3272322976436525`*^63", ",", 
   "2.6864549525804407`*^67", ",", "1.0012904929442662`*^73", ",", 
   "4.542463137806417`*^69", ",", "2.461633853111844`*^83", ",", 
   "2.900758223292845`*^87", ",", "6.21643293650995`*^93", ",", 
   "3.920507731805178`*^85", ",", "9.04618639537573`*^90", ",", 
   "1.5664957028235047`*^97", ",", "2.0108675209162106`*^103", ",", 
   "5.384582211022176`*^96", ",", "2.3681023472470536`*^102", ",", 
   "3.100271644816728`*^95", ",", "1.1942180832152868`*^105", ",", 
   "8.264465631756622`*^109", ",", "2.3536762363941217`*^106", ",", 
   "4.322134392873218`*^107", ",", "6.096046173860251`*^95", ",", 
   "3.8969367645263345`*^110", ",", "1.9032034324192873`*^111", ",", 
   "5.132438489106588`*^107", ",", "2.2294423312998178`*^114", ",", 
   "2.1676415878605356`*^97", ",", "1.1204484376916602`*^102", ",", 
   "4.594566953034609`*^96", ",", "9.307715046316002`*^90", ",", 
   "1.5908507068740766`*^85", ",", "2.006050335776617`*^84", ",", 
   "1.978417652596205`*^83"}], "}"}]], "Output",
 CellChangeTimes->{3.905208743557053*^9, 3.905209368943152*^9},
 CellLabel->
  "Out[633]=",ExpressionUUID->"0d220b64-c88f-40da-a092-592a9115f2b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"exptab", "/", 
    RowBox[{"Total", "[", "exptab", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", "ptab"}], "Input",
 CellChangeTimes->{{3.905204184514991*^9, 3.905204240867041*^9}, {
   3.905204280768991*^9, 3.90520431138422*^9}, 3.9052043803257923`*^9, 
   3.905206789114182*^9, 3.90520873778922*^9, {3.905208776397973*^9, 
   3.90520878431851*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"355cca6b-4bef-4c04-887d-417a51449808"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.48065040320095`*^-115", ",", "4.51376803336001`*^-101", ",", 
   "1.2815985904410112`*^-97", ",", "1.4401929134533544`*^-57", ",", 
   "5.9468639295783554`*^-52", ",", "1.2037065466460742`*^-47", ",", 
   "4.4864326509320045`*^-42", ",", "2.0353189289937778`*^-45", ",", 
   "1.1029720716478693`*^-31", ",", "1.2997283502785558`*^-27", ",", 
   "2.7853662743444975`*^-21", ",", "1.7566424549265315`*^-29", ",", 
   "4.053279871987122`*^-24", ",", "7.018919602468692`*^-18", ",", 
   "9.009994368376914`*^-12", ",", "2.4126430454885178`*^-18", ",", 
   "1.0610638737013627`*^-12", ",", "1.3891233395380544`*^-19", ",", 
   "5.350873736068442`*^-10", ",", "0.0000370301812651707`", ",", 
   "1.0546000377603818`*^-8", ",", "1.9365973210116078`*^-7", ",", 
   "2.7314251746838544`*^-19", ",", "0.00017460811285223527`", ",", 
   "0.0008527589226842913`", ",", "2.2996662585619512`*^-7", ",", 
   "0.9989351680651796`", ",", "9.712444154642458`*^-18", ",", 
   "5.020337744109012`*^-13", ",", "2.0586648270648283`*^-18", ",", 
   "4.170461717515535`*^-24", ",", "7.128045861187849`*^-30", ",", 
   "8.988410245838902`*^-31", ",", "8.864597852805064`*^-32"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.905208784668281*^9, 3.9052093689712*^9},
 CellLabel->
  "Out[635]=",ExpressionUUID->"0fd05526-f616-4475-975e-ebbfdcb1a753"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"ptab", "+", "const"}], ",", "const"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "ptab"}], "Input",
 CellChangeTimes->{{3.905204184514991*^9, 3.905204240867041*^9}, {
   3.905204280768991*^9, 3.90520431138422*^9}, 3.9052043803257923`*^9, 
   3.905206789114182*^9, 3.90520873778922*^9, 3.905208776397973*^9, {
   3.9052088130011597`*^9, 3.905208815598774*^9}},
 CellLabel->
  "In[636]:=",ExpressionUUID->"fe888b6a-613f-48f3-86e4-fc50c44f9c38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", 
   "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", 
   "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", 
   "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", 
   "1.`*^-10", ",", "1.`*^-10", ",", "6.`*^-10", ",", "0.0000370303`", ",", 
   "1.06`*^-8", ",", "1.938`*^-7", ",", "1.`*^-10", ",", "0.0001746082`", ",",
    "0.000852759`", ",", "2.301`*^-7", ",", "0.9989351682`", ",", "1.`*^-10", 
   ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", "1.`*^-10", ",", 
   "1.`*^-10", ",", "1.`*^-10"}], "}"}]], "Output",
 CellChangeTimes->{3.905208815963462*^9, 3.905209368976493*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"0ceedcdf-ce43-4a4a-a4b9-a6ae6260da36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptab", "=", 
   RowBox[{"N", "[", 
    RowBox[{"ptab", "/", 
     RowBox[{"Total", "[", "ptab", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "ptab"}], "Input",
 CellChangeTimes->{{3.905204184514991*^9, 3.905204240867041*^9}, {
   3.905204280768991*^9, 3.90520431138422*^9}, 3.9052043803257923`*^9, 
   3.905206789114182*^9, 3.90520873778922*^9, 3.905208776397973*^9, 
   3.9052088130011597`*^9, {3.905208956910913*^9, 3.905208960052999*^9}},
 CellLabel->
  "In[638]:=",ExpressionUUID->"3b6dc96f-6613-4f7d-acaa-f63fce65882e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "5.999999979600001`*^-10", ",", "0.000037030299874096986`", ",", 
   "1.0599999963960003`*^-8", ",", "1.9379999934108002`*^-7", ",", 
   "9.999999966000001`*^-11", ",", "0.00017460819940633214`", ",", 
   "0.0008527589971006195`", ",", "2.3009999921766004`*^-7", ",", 
   "0.9989351648036205`", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11", ",", 
   "9.999999966000001`*^-11", ",", "9.999999966000001`*^-11"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.90520896051812*^9, 3.905209368996703*^9},
 CellLabel->
  "Out[639]=",ExpressionUUID->"dab0f43d-84e5-42b4-9fc8-3d18edd02600"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"field01", "[", 
    RowBox[{"[", "j", "]"}], "]"}], "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"MultinomialDistribution", "[", 
     RowBox[{"1", ",", "ptab"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"field", "[", 
    RowBox[{"[", "j", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"field01", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nf", "[", 
    RowBox[{"[", 
     RowBox[{"field", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Nf", "[", 
     RowBox[{"[", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ncf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ncf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", "Nc"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ccf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Ccf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
    RowBox[{"Cjc", "[", 
     RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fcf", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"field", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Fcf", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"field", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "+", 
    RowBox[{"Fjc", "[", 
     RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.905204184514991*^9, 3.905204240867041*^9}, {
   3.905204280768991*^9, 3.90520431138422*^9}, 3.9052043803257923`*^9, 
   3.905206789114182*^9, 3.90520873778922*^9, 3.905208776397973*^9, 
   3.9052088130011597`*^9, 3.905208956910913*^9},
 CellLabel->
  "In[640]:=",ExpressionUUID->"71c03995-bf43-4784-b7fa-b0f4dd22616a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Ccf", "]"}]], "Input",
 CellChangeTimes->{{3.9052046016907587`*^9, 3.9052046924917707`*^9}, {
  3.905206786808147*^9, 3.9052068243868837`*^9}, {3.905208408749207*^9, 
  3.905208409209819*^9}, {3.905208564007141*^9, 3.905208564519361*^9}, {
  3.905209072693452*^9, 3.905209073547557*^9}, {3.905209319126429*^9, 
  3.905209319263813*^9}, {3.9052093596634197`*^9, 3.905209359936555*^9}, {
  3.9052094337328243`*^9, 3.905209452923829*^9}},
 CellLabel->
  "In[649]:=",ExpressionUUID->"621c0b99-ecac-4c2c-9044-63af11019180"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "1", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"6", "6", "7", "0", "2", "0", "2", "1", "0", "0", "1", "0", "2", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1"},
     {"13", "11", "14", "0", "2", "0", "5", "3", "0", "0", "0", "0", "1", "1",
       "0", "4", "2", "3", "0", "0", "0", "2", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1"},
     {"18", "19", "23", "2", "8", "1", "11", "3", "0", "2", "5", "1", "9", 
      "1", "1", "8", "3", "6", "2", "2", "5", "0", "7", "0", "0", "1", "0", 
      "2", "0", "0", "0", "0", "0", "0"},
     {"30", "26", "27", "4", "7", "2", "18", "2", "2", "1", "8", "2", "8", 
      "4", "2", "7", "6", "9", "6", "0", "5", "3", "5", "2", "0", "1", "0", 
      "1", "0", "1", "0", "1", "0", "0"},
     {"24", "28", "27", "8", "8", "6", "15", "13", "3", "1", "7", "3", "13", 
      "4", "0", "8", "6", "11", "1", "3", "3", "4", "7", "1", "0", "4", "0", 
      "7", "0", "0", "0", "0", "0", "1"},
     {"21", "19", "19", "5", "8", "5", "9", "4", "3", "1", "8", "1", "9", "4",
       "1", "6", "6", "6", "1", "0", "3", "1", "3", "1", "0", "0", "2", "2", 
      "0", "0", "1", "1", "4", "0"},
     {"22", "19", "22", "11", "14", "11", "14", "10", "8", "6", "8", "5", "7",
       "2", "5", "5", "4", "10", "4", "2", "4", "2", "5", "2", "0", "2", "2", 
      "4", "0", "0", "3", "1", "1", "1"},
     {"14", "15", "14", "11", "7", "10", "8", "8", "5", "7", "3", "3", "9", 
      "2", "3", "3", "3", "4", "3", "2", "2", "2", "4", "4", "0", "1", "2", 
      "1", "0", "0", "0", "1", "1", "1"},
     {"26", "24", "22", "18", "13", "18", "14", "12", "8", "9", "11", "2", 
      "13", "5", "8", "10", "8", "6", "6", "4", "5", "6", "4", "3", "0", "1", 
      "9", "3", "0", "1", "0", "1", "0", "0"},
     {"17", "14", "15", "13", "7", "14", "9", "6", "7", "8", "7", "2", "8", 
      "4", "8", "4", "6", "4", "3", "5", "2", "3", "4", "2", "1", "2", "10", 
      "2", "0", "0", "0", "0", "0", "0"},
     {"16", "14", "16", "15", "12", "14", "10", "11", "5", "9", "12", "6", 
      "6", "4", "11", "6", "5", "6", "2", "5", "2", "3", "7", "3", "3", "1", 
      "10", "1", "0", "0", "0", "0", "0", "1"},
     {"17", "17", "16", "19", "18", "16", "9", "16", "15", "10", "10", "14", 
      "6", "11", "6", "7", "11", "6", "5", "4", "2", "2", "6", "2", "2", "2", 
      "1", "3", "2", "0", "4", "1", "0", "0"},
     {"16", "15", "15", "14", "16", "12", "12", "14", "14", "8", "5", "13", 
      "8", "8", "7", "8", "4", "5", "3", "3", "5", "0", "4", "2", "2", "3", 
      "1", "3", "0", "0", "2", "1", "1", "0"},
     {"19", "18", "16", "19", "16", "18", "18", "16", "16", "15", "9", "14", 
      "8", "10", "8", "4", "11", "11", "9", "5", "3", "0", "4", "4", "7", "2",
       "12", "3", "4", "1", "0", "0", "0", "0"},
     {"24", "24", "21", "24", "21", "22", "17", "21", "19", "15", "17", "19", 
      "13", "14", "13", "12", "10", "7", "6", "10", "9", "2", "4", "8", "6", 
      "6", "12", "6", "1", "0", "1", "0", "0", "0"},
     {"25", "24", "22", "23", "23", "23", "19", "22", "20", "24", "16", "20", 
      "14", "18", "16", "12", "14", "7", "15", "13", "4", "8", "3", "7", "7", 
      "1", "18", "1", "2", "1", "3", "0", "0", "0"},
     {"13", "11", "11", "13", "12", "13", "8", "13", "12", "12", "9", "12", 
      "5", "11", "8", "10", "6", "6", "9", "5", "5", "1", "3", "3", "4", "6", 
      "6", "3", "2", "1", "1", "0", "0", "0"},
     {"9", "8", "7", "9", "7", "9", "7", "9", "8", "8", "8", "8", "5", "7", 
      "8", "4", "3", "5", "6", "6", "4", "4", "4", "3", "4", "3", "5", "0", 
      "2", "1", "0", "0", "0", "0"},
     {"20", "20", "17", "20", "20", "19", "13", "20", "19", "20", "13", "20", 
      "13", "17", "15", "9", "9", "10", "16", "14", "11", "12", "4", "5", "7",
       "9", "14", "5", "4", "2", "3", "0", "0", "0"},
     {"11", "13", "12", "13", "13", "13", "8", "12", "13", "13", "9", "12", 
      "8", "12", "9", "9", "6", "6", "9", "8", "7", "9", "3", "7", "8", "7", 
      "14", "3", "3", "1", "2", "0", "0", "0"},
     {"11", "11", "10", "11", "11", "11", "10", "11", "11", "11", "9", "11", 
      "4", "10", "10", "8", "8", "6", "9", "7", "7", "6", "1", "4", "6", "7", 
      "18", "2", "1", "0", "0", "0", "0", "0"},
     {"8", "7", "7", "8", "7", "8", "7", "8", "8", "8", "8", "8", "5", "8", 
      "8", "8", "3", "5", "5", "7", "6", "2", "0", "7", "7", "4", "10", "0", 
      "1", "3", "0", "2", "1", "0"},
     {"13", "13", "13", "13", "13", "13", "10", "13", "13", "13", "11", "13", 
      "12", "13", "12", "9", "10", "8", "12", "9", "6", "10", "6", "8", "10", 
      "7", "18", "4", "5", "2", "0", "0", "0", "0"},
     {"7", "6", "7", "7", "7", "7", "6", "7", "7", "7", "6", "7", "6", "6", 
      "7", "6", "5", "3", "7", "6", "6", "6", "2", "3", "3", "6", "9", "3", 
      "7", "3", "0", "0", "0", "0"},
     {"6", "5", "6", "6", "6", "6", "6", "6", "6", "6", "5", "6", "5", "6", 
      "6", "6", "5", "4", "4", "5", "5", "4", "0", "5", "6", "5", "10", "1", 
      "4", "2", "3", "0", "0", "0"},
     {"4", "4", "3", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", 
      "3", "3", "2", "1", "4", "4", "4", "4", "3", "4", "4", "4", "8", "0", 
      "2", "3", "0", "0", "0", "0"},
     {"3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "2", "3", 
      "3", "1", "3", "1", "3", "3", "3", "2", "2", "3", "3", "3", "6", "1", 
      "2", "2", "2", "0", "0", "0"},
     {"5", "5", "5", "5", "5", "5", "4", "5", "5", "5", "5", "5", "3", "5", 
      "5", "5", "4", "5", "5", "5", "4", "5", "3", "5", "5", "4", "8", "3", 
      "4", "3", "2", "1", "1", "1"},
     {"2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "1", "2", 
      "2", "2", "2", "1", "2", "2", "2", "2", "2", "2", "2", "2", "3", "0", 
      "2", "1", "1", "1", "1", "1"},
     {"1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", 
      "1", "1", "1", "1", "1", "1", "1", "1", "0", "1", "1", "1", "0", "0", 
      "1", "1", "1", "1", "1", "1"},
     {"1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", 
      "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "2", "1", 
      "1", "1", "0", "1", "1", "1"},
     {"15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", 
      "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", 
      "15", "15", "30", "15", "15", "15", "15", "15", "15", "15"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9052046123108177`*^9, 3.905204692973175*^9}, {
   3.905206797154173*^9, 3.905206824890894*^9}, 3.9052084096175756`*^9, 
   3.905208565321947*^9, 3.9052090739109917`*^9, 3.905209320677827*^9, {
   3.905209360992918*^9, 3.905209369019651*^9}, {3.905209435047112*^9, 
   3.9052094533755713`*^9}},
 CellLabel->
  "Out[649]//MatrixForm=",ExpressionUUID->"a881d22c-a314-443c-a4bb-\
1fe467d209fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"llm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Ccf", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"Pcf", "+", "const"}], "]"}]}], "+", 
      RowBox[{"Fcf", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "Pcf", "+", "const"}], "]"}]}]}], ",", "2"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"df", "=", 
   RowBox[{
    RowBox[{"samplesize", "*", "testlength"}], "-", 
    RowBox[{"nclass", "*", "nfield"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bic", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], "*", "llm"}], "-", 
    RowBox[{"df", "*", 
     RowBox[{"Log", "[", "samplesize", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indices", "=", 
   RowBox[{"{", 
    RowBox[{"llm", ",", "df", ",", "bic"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "indices"}], "Input",
 CellChangeTimes->{{3.90521905737376*^9, 3.905219058807742*^9}},
 CellLabel->
  "In[677]:=",ExpressionUUID->"c18e0920-4524-4aed-98b8-ef6fd00a8c3b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "9535.973159080535`"}], ",", "17869", ",", 
   RowBox[{"-", "92505.07202979922`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9052190596030493`*^9},
 CellLabel->
  "Out[681]=",ExpressionUUID->"2f69675a-9210-4b8f-ae86-3a470a44d37e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeropos", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"totalscore", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "zeropos"}], "Input",
 CellChangeTimes->{{3.9052200965925283`*^9, 3.90522009956008*^9}, {
  3.905220242801812*^9, 3.9052202546211023`*^9}},
 CellLabel->
  "In[684]:=",ExpressionUUID->"34fcb5e0-d59b-49af-95fb-3f27e1c1348d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "269", "}"}], ",", 
   RowBox[{"{", "330", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.905220100443791*^9, {3.905220244287072*^9, 3.905220254968708*^9}},
 CellLabel->
  "Out[685]=",ExpressionUUID->"01afc772-4dc8-4a01-81f9-74bb7e4efd3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<Reorganizing small-sized classes\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<N of Reorganized Classes\>\"", ",", "\"\<N of Classes\>\""}],
     "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeropos", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"totalscore", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullpos", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"totalscore", ",", "testlength"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delt", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delrep", "=", "nclass"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EMrep", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"const", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[686]:=",ExpressionUUID->"99fefbee-7e57-49e1-85c4-841d2ea79153"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Reorganizing small-sized classes\"\>"], "Print",
 CellChangeTimes->{3.905220467743436*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[686]:=",ExpressionUUID->"cbabcd08-ba92-4071-\
90f9-121163f404b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"N of Reorganized Classes\"\>", ",", "\<\"N of Classes\"\>"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.905220467744493*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[686]:=",ExpressionUUID->"1a18926d-f675-40ac-\
8dd4-40a456d609a0"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"3453d853-cc72-421b-9b02-26f096e811b8"]
},
WindowSize->{1920, 1027},
WindowMargins->{{-1920, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (2023\:5e746\:67083\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"59d8b610-006f-423b-af59-12cd02547234"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 843, 23, 310, "Input",ExpressionUUID->"68227bcb-33ce-4816-81d0-586ac14db2e2"],
Cell[CellGroupData[{
Cell[1448, 49, 390, 7, 36, "Print",ExpressionUUID->"6dc0dc77-0c7d-46d3-a8ea-a16080cf3ff2"],
Cell[1841, 58, 1156, 29, 226, "Print",ExpressionUUID->"060d0abd-e13b-4ee2-9ce0-c4963ca6d765"],
Cell[3000, 89, 390, 7, 36, "Print",ExpressionUUID->"801561e6-a950-400f-af21-772c13b93d47"],
Cell[3393, 98, 4848, 92, 872, "Print",ExpressionUUID->"d05c3d2c-3881-402d-b2d7-4dade48a8b64"]
}, Open  ]]
}, Open  ]],
Cell[8268, 194, 1616, 50, 422, "Input",ExpressionUUID->"a7133a94-e163-429c-91fe-7ebe62a287ca"],
Cell[9887, 246, 2703, 83, 475, "Input",ExpressionUUID->"f478c19d-96bc-49b4-acbd-648638abd50c"],
Cell[CellGroupData[{
Cell[12615, 333, 390, 8, 97, "Input",ExpressionUUID->"194ff1b1-4a7e-4934-94d5-5ef3815f6f00"],
Cell[13008, 343, 673, 12, 52, "Output",ExpressionUUID->"009977ec-d4b5-43d9-b2bf-35dab0572cd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13718, 360, 1657, 53, 348, "Input",ExpressionUUID->"129186ae-e44c-4e72-afb7-c91543af309a"],
Cell[15378, 415, 14935, 265, 1076, "Output",ExpressionUUID->"bfbb6bbb-b994-45e3-a6b8-4e3c645a5b3e"]
}, Open  ]],
Cell[30328, 683, 1568, 47, 298, "Input",ExpressionUUID->"5a3deebe-08db-4740-9e46-b2569d85c364"],
Cell[31899, 732, 2501, 80, 313, "Input",ExpressionUUID->"5e993d7b-753b-40c8-b2b8-ce8dd3059d06"],
Cell[34403, 814, 2588, 65, 560, "Input",ExpressionUUID->"144d9d89-fd3e-499c-8678-5ef8db9c23ae"],
Cell[CellGroupData[{
Cell[37016, 883, 3940, 98, 294, "Input",ExpressionUUID->"f63983b6-3843-4b82-a04b-360360102924"],
Cell[40959, 983, 1832, 40, 115, "Output",ExpressionUUID->"9dba9fd5-c1b3-4e8e-99af-30e17839777c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42828, 1028, 578, 13, 155, "Input",ExpressionUUID->"7dd7bf9b-e936-4fdb-b471-1a35d42c9a49"],
Cell[43409, 1043, 1328, 22, 151, "Output",ExpressionUUID->"0d220b64-c88f-40da-a092-592a9115f2b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44774, 1070, 492, 11, 101, "Input",ExpressionUUID->"355cca6b-4bef-4c04-887d-417a51449808"],
Cell[45269, 1083, 1365, 23, 151, "Output",ExpressionUUID->"0fd05526-f616-4475-975e-ebbfdcb1a753"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46671, 1111, 576, 13, 101, "Input",ExpressionUUID->"fe888b6a-613f-48f3-86e4-fc50c44f9c38"],
Cell[47250, 1126, 837, 14, 120, "Output",ExpressionUUID->"0ceedcdf-ce43-4a4a-a4b9-a6ae6260da36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48124, 1145, 566, 12, 101, "Input",ExpressionUUID->"3b6dc96f-6613-4f7d-acaa-f63fce65882e"],
Cell[48693, 1159, 1353, 23, 120, "Output",ExpressionUUID->"dab0f43d-84e5-42b4-9fc8-3d18edd02600"]
}, Open  ]],
Cell[50061, 1185, 2559, 80, 313, "Input",ExpressionUUID->"71c03995-bf43-4784-b7fa-b0f4dd22616a"],
Cell[CellGroupData[{
Cell[52645, 1269, 561, 9, 66, "Input",ExpressionUUID->"621c0b99-ecac-4c2c-9044-63af11019180"],
Cell[53209, 1280, 7610, 123, 926, "Output",ExpressionUUID->"a881d22c-a314-443c-a4bb-1fe467d209fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60856, 1408, 1075, 33, 217, "Input",ExpressionUUID->"c18e0920-4524-4aed-98b8-ef6fd00a8c3b"],
Cell[61934, 1443, 286, 7, 52, "Output",ExpressionUUID->"2f69675a-9210-4b8f-ae86-3a470a44d37e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62257, 1455, 383, 9, 101, "Input",ExpressionUUID->"34fcb5e0-d59b-49af-95fb-3f27e1c1348d"],
Cell[62643, 1466, 299, 8, 52, "Output",ExpressionUUID->"01afc772-4dc8-4a01-81f9-74bb7e4efd3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62979, 1479, 1024, 29, 356, "Input",ExpressionUUID->"99fefbee-7e57-49e1-85c4-841d2ea79153"],
Cell[CellGroupData[{
Cell[64028, 1512, 217, 4, 36, "Print",ExpressionUUID->"cbabcd08-ba92-4071-90f9-121163f404b6"],
Cell[64248, 1518, 276, 7, 36, "Print",ExpressionUUID->"1a18926d-f675-40ac-8dd4-40a456d609a0"]
}, Open  ]]
}, Open  ]],
Cell[64551, 1529, 81, 0, 46, "Input",ExpressionUUID->"3453d853-cc72-421b-9b02-26f096e811b8"]
}
]
*)

