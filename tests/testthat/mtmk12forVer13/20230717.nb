(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80534,       2144]
NotebookOptionsPosition[     66798,       1964]
NotebookOutlinePosition[     67238,       1981]
CellTagsIndexPosition[     67195,       1978]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"datafile", "=", "\"\<J15S500.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemlabelrow", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"studentIDcolumn", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mi", "=", 
    RowBox[{"-", "99"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nrank", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"method", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mic", "=", "0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"dir", "<>", "\"\<mod/Module_CTT.nb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"itemstat", "[", "data", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.898540332993984*^9, 3.898540397963469*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"bdb27c93-289a-402e-8ed5-52ca9b86edb4"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Test Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.8985404012200108`*^9, 3.898544441012471*^9, 3.898545994331087*^9, {
   3.89854615580309*^9, 3.8985461800305977`*^9}, 3.8985463748936243`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"de679119-6f4a-4215-83cd-\
63a722767001"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"N of Items\"\>", "15"},
     {"\<\"Sample Size\"\>", "500"},
     {"\<\"Mean\"\>", "9.664`"},
     {"\<\"SE of Mean\"\>", "0.11907378019639975`"},
     {"\<\"SD\"\>", "2.662570668570181`"},
     {"\<\"Skewness\"\>", 
      RowBox[{"-", "0.4116219753662485`"}]},
     {"\<\"Kurtosis\"\>", 
      RowBox[{"-", "0.4471624041427025`"}]},
     {"\<\"Min\"\>", "2"},
     {"\<\"Max\"\>", "15"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.8985404012200108`*^9, 3.898544441012471*^9, 3.898545994331087*^9, {
   3.89854615580309*^9, 3.8985461800305977`*^9}, 3.8985463749006433`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"eb8bbfb0-8879-4a38-b153-\
a179a5b913d8"],

Cell[BoxData["\<\"Item Statistics\"\>"], "Print",
 CellChangeTimes->{
  3.8985404012200108`*^9, 3.898544441012471*^9, 3.898545994331087*^9, {
   3.89854615580309*^9, 3.8985461800305977`*^9}, 3.898546374902301*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"8d8690e9-a14a-4906-bfc1-\
b9b657783e4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Item\"\>", "\<\"Number of Respondents\"\>", "\<\"Correct Response \
Rate\"\>", "\<\"Item Threshold\"\>", "\<\"Item-Total Correlation\"\>"},
     {"\<\"Item01\"\>", "500", "0.746`", 
      RowBox[{"-", "0.6619550962881617`"}], "0.37464809977856733`"},
     {"\<\"Item02\"\>", "500", "0.754`", 
      RowBox[{"-", "0.6871312867954693`"}], "0.39320458581499584`"},
     {"\<\"Item03\"\>", "500", "0.726`", 
      RowBox[{"-", "0.6007597742493189`"}], "0.3213002998863171`"},
     {"\<\"Item04\"\>", "500", "0.776`", 
      RowBox[{"-", "0.758753544504371`"}], "0.5028238995207028`"},
     {"\<\"Item05\"\>", "500", "0.804`", 
      RowBox[{"-", "0.8559959854926822`"}], "0.32905385417199745`"},
     {"\<\"Item06\"\>", "500", "0.864`", 
      RowBox[{"-", "1.098468420339863`"}], "0.3768598492052685`"},
     {"\<\"Item07\"\>", "500", "0.716`", 
      RowBox[{"-", "0.5709994731129874`"}], "0.4830671719795533`"},
     {"\<\"Item08\"\>", "500", "0.588`", 
      RowBox[{"-", "0.22240322692720624`"}], "0.4052151601002186`"},
     {"\<\"Item09\"\>", "500", "0.364`", "0.3477872042786274`", 
      "0.22482031165466698`"},
     {"\<\"Item10\"\>", "500", "0.662`", 
      RowBox[{"-", "0.4179276716694819`"}], "0.3144455737746086`"},
     {"\<\"Item11\"\>", "500", "0.286`", "0.5651084520065837`", 
      "0.45508093046361303`"},
     {"\<\"Item12\"\>", "500", "0.274`", "0.6007597742493189`", 
      "0.4677839479807731`"},
     {"\<\"Item13\"\>", "500", "0.634`", 
      RowBox[{"-", "0.34246630146539064`"}], "0.47125021147891244`"},
     {"\<\"Item14\"\>", "500", "0.764`", 
      RowBox[{"-", "0.7192287304399239`"}], "0.48484126159196433`"},
     {"\<\"Item15\"\>", "500", "0.706`", 
      RowBox[{"-", "0.5417365601128167`"}], "0.41277466892977605`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.8985404012200108`*^9, 3.898544441012471*^9, 3.898545994331087*^9, {
   3.89854615580309*^9, 3.8985461800305977`*^9}, 3.898546374903042*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[25]:=",ExpressionUUID->"4f5adac4-3102-4122-a0cb-\
db06a052c281"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[332]:=",ExpressionUUID->"046d7bc3-ac91-4620-b146-a2120185cab1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"const", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", "testlength"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clsnum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "ncls"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obsnum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "samplesize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clsrefmat", "=", 
    RowBox[{"N", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"c", "/", 
           RowBox[{"(", 
            RowBox[{"ncls", "+", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "1", ",", "ncls"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "testlength", "}"}]}], "]"}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"C", "*", "J"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"somt", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxT", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alp1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpT", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sig1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigT", "=", "0.12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alplist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"maxT", "-", "t"}], ")"}], "*", "alp1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "-", "1"}], ")"}], "*", "alpT"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"maxT", "-", "1"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "1", ",", "maxT"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"siglist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"maxT", "-", "t"}], ")"}], "*", "sig1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "-", "1"}], ")"}], "*", "sigT"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"maxT", "-", "1"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "1", ",", "maxT"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kap1", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kapT", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kaplist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"maxT", "-", "t"}], ")"}], "*", "kap1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "-", "1"}], ")"}], "*", "kapT"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"maxT", "-", "1"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "1", ",", "maxT"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"priorlist", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"1", "/", "ncls"}], ",", 
      RowBox[{"{", "ncls", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hhhmat", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"alplist", "[", 
          RowBox[{"[", "t", "]"}], "]"}], "*", 
         RowBox[{"ncls", "/", "samplesize"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"r", "^", "2"}]}], "/", "2"}], "/", 
            RowBox[{"ncls", "^", "2"}]}], "/", 
           RowBox[{
            RowBox[{"siglist", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "^", "2"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "maxT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{
           RowBox[{"-", "ncls"}], "+", "1"}], ",", 
          RowBox[{"ncls", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refmat", "=", 
   RowBox[{"Transpose", "[", "clsrefmat", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[333]:=",ExpressionUUID->"0918c56e-7ab3-4bee-8162-5511bcd31d03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hhhmat", "[", 
  RowBox[{"[", "10", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8985404368486643`*^9, 3.8985404404009333`*^9}, {
  3.89854053060205*^9, 3.89854053331186*^9}, {3.898540590571465*^9, 
  3.898540592973033*^9}, {3.898540780535203*^9, 3.8985408479984818`*^9}, {
  3.898540899446157*^9, 3.8985409442321568`*^9}, {3.89854098133552*^9, 
  3.89854100845793*^9}, {3.898542823672394*^9, 3.898542838612802*^9}, {
  3.898543895610464*^9, 3.8985439207895517`*^9}, {3.898543993699047*^9, 
  3.898543994053746*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"f68ffab5-103e-4060-997e-341cad9bdb0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.007245`", ",", "0.008398`", ",", "0.009421`", ",", "0.010226`", ",", 
   "0.010742`", ",", "0.01092`", ",", "0.010742`", ",", "0.010226`", ",", 
   "0.009421`", ",", "0.008398`", ",", "0.007245`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8985428116418953`*^9, 3.898542839241618*^9}, {
   3.898543898924402*^9, 3.8985439219407787`*^9}, 3.898543995194173*^9, 
   3.898544441106236*^9, 3.898545994437489*^9, {3.898546155882606*^9, 
   3.898546180115777*^9}, 3.898546374969108*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"d61265f5-3e7b-49f1-b889-c51c043c5cdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["priorlist"], "Input",
 CellChangeTimes->{{3.898541020994874*^9, 3.898541022719886*^9}, {
  3.898541559052228*^9, 3.89854160801565*^9}, {3.898541868263028*^9, 
  3.8985418742735147`*^9}, {3.8985432664327583`*^9, 3.898543268050933*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"a6111750-f656-4121-bce5-fe92a2a5f831"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16666666666666666`", ",", "0.16666666666666666`", ",", 
   "0.16666666666666666`", ",", "0.16666666666666666`", ",", 
   "0.16666666666666666`", ",", "0.16666666666666666`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.898541024637639*^9, {3.898541561472781*^9, 3.898541608405107*^9}, 
   3.898541874708205*^9, 3.898543268402021*^9, 3.898544184488244*^9, 
   3.898544441109941*^9, 3.898545994441935*^9, {3.898546155886388*^9, 
   3.898546180119709*^9}, 3.898546374972849*^9},
 CellLabel->
  "Out[352]=",ExpressionUUID->"27a73548-08fd-4c84-9a06-a8a00df6fcda"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"somt", "+=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Total", "[", "uuu", "]"}], "]"}], "+", "somt"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"is", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], ",", 
          RowBox[{"{", "samplesize", "}"}]}], "]"}], ",", "obsnum"}], "}"}], 
      "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loglike", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8985441879496727`*^9, {3.898544417189787*^9, 3.898544419006762*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"dbfbb01a-9e76-4a51-bdc2-461cf4690eff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Total", "[", "uuu", "]"}], "]"}], "+", "somt"}]], "Input",
 CellChangeTimes->{{3.898544452426972*^9, 3.898544469991242*^9}, {
  3.898544744905937*^9, 3.89854475682437*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"c53d326e-5351-4b19-b07f-46a82970d9e8"],

Cell[BoxData["4833"], "Output",
 CellChangeTimes->{
  3.89854599445328*^9, {3.898546155892623*^9, 3.898546180125889*^9}, 
   3.898546375002562*^9},
 CellLabel->
  "Out[357]=",ExpressionUUID->"22d32180-886f-4e62-af3d-2d5fa308d84b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"is", "[", 
    RowBox[{"[", "s", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlrank", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"uuu", "[", 
      RowBox[{"[", "ss", "]"}], "]"}], ".", 
     RowBox[{"Log", "[", 
      RowBox[{"refmat", "+", "const"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zzz", "[", 
        RowBox[{"[", "ss", "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"uuu", "[", 
          RowBox[{"[", "ss", "]"}], "]"}]}], ")"}]}], ")"}], ".", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "refmat", "+", "const"}], "]"}]}], "+", 
    RowBox[{"Log", "[", "priorlist", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wrank", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"mlrank", ",", "clsnum"}], "}"}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.898544578875657*^9, 3.898544601242799*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"f8681ab5-f7ce-4b63-9812-9589d8604f98"],

Cell[CellGroupData[{

Cell[BoxData["wrank"], "Input",
 CellChangeTimes->{{3.898545029843886*^9, 3.898545030051508*^9}, {
  3.8985452529876003`*^9, 3.8985452539864388`*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"6d69c509-6463-42e6-9509-7057121cf4ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "11.912079622378865`"}], ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8985450310101233`*^9, 3.898545254610386*^9, 3.898545994487276*^9, {
   3.898546155935158*^9, 3.898546180159823*^9}, 3.8985463750141783`*^9},
 CellLabel->
  "Out[362]=",ExpressionUUID->"a60030b1-bb7e-4867-ac3e-57f10d991d88"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"loglike", "+=", 
   RowBox[{"wrank", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.898544608372723*^9, 3.898544677448399*^9}, 
   3.898545291798903*^9},
 CellLabel->
  "In[363]:=",ExpressionUUID->"b37e64a8-83a7-4695-99cd-b021b100e1ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hhh", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"hhhmat", "[", 
        RowBox[{"[", "somt", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ncls", "+", "1", "-", 
          RowBox[{"wrank", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"2", "ncls"}], "-", 
          RowBox[{"wrank", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "testlength", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "refmat"}], "Input",
 CellChangeTimes->{{3.8985452979107037`*^9, 3.898545298961187*^9}, {
  3.898545350555037*^9, 3.8985453518121433`*^9}, {3.898546171779366*^9, 
  3.898546175478806*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"bd0aa962-a8f6-4e78-a74a-a94b6877c600"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
     "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
     "0.7142857142857143`", ",", "0.8571428571428571`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8985461801892233`*^9, 3.898546375040551*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"241117e8-3653-4e4d-a23e-194fb596b8d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"uuu", "[", 
   RowBox[{"[", "ss", "]"}], "]"}], "-", "refmat"}]], "Input",
 CellChangeTimes->{{3.898545356649605*^9, 3.898545386920327*^9}, {
   3.898545419468318*^9, 3.898545450719408*^9}, 3.898546124411583*^9},
 CellLabel->
  "In[366]:=",ExpressionUUID->"bac64ef3-18e3-4237-8e0c-bd1e311fbd3e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.14285714285714285`"}], ",", 
     RowBox[{"-", "0.2857142857142857`"}], ",", 
     RowBox[{"-", "0.42857142857142855`"}], ",", 
     RowBox[{"-", "0.5714285714285714`"}], ",", 
     RowBox[{"-", "0.7142857142857143`"}], ",", 
     RowBox[{"-", "0.8571428571428571`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8571428571428572`", ",", "0.7142857142857143`", ",", 
     "0.5714285714285714`", ",", "0.4285714285714286`", ",", 
     "0.2857142857142857`", ",", "0.1428571428571429`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.89854557781509*^9, 3.898545994496202*^9, {3.898546126175544*^9, 
   3.898546180194356*^9}, 3.8985463750688667`*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"cbf151cf-1853-48b6-8be3-73d038ae2d38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"refmat", "+=", 
   RowBox[{"hhh", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"uuu", "[", 
       RowBox[{"[", "ss", "]"}], "]"}], "-", "refmat"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", "refmat"}], "Input",
 CellChangeTimes->{{3.898545546731835*^9, 3.8985455507234507`*^9}, {
  3.898545971216876*^9, 3.898545978185525*^9}, {3.8985462665869427`*^9, 
  3.898546266908004*^9}, {3.898546355104412*^9, 3.898546356553566*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"f03e620f-4e8a-4638-a0e9-32ee81a6698d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1413442857142857`", ",", "0.28247085714285713`", ",", 
     "0.42349971428571426`", ",", "0.5645714285714285`", ",", 
     "0.7058328571428572`", ",", "0.8474125714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15193428571428572`", ",", "0.2938228571428571`", ",", 
     "0.43533371428571427`", ",", "0.5765714285714285`", ",", 
     "0.7176668571428572`", ",", "0.8587645714285714`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.898545978928371*^9, 3.898545994507304*^9}, {
   3.8985461559663773`*^9, 3.898546180199383*^9}, 3.89854626874541*^9, {
   3.898546356891388*^9, 3.898546375074121*^9}},
 CellLabel->
  "Out[368]=",ExpressionUUID->"baaf4d84-a01c-44a2-951e-e52b381f41bf"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"priorlist", "[", 
      RowBox[{"[", "r", "]"}], "]"}], "=", 
     RowBox[{"Min", "[", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"priorlist", "[", 
         RowBox[{"[", "r", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"kaplist", "[", 
          RowBox[{"[", "somt", "]"}], "]"}], "/", "ncls"}]}]}], "]"}]}], ",", 
    
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "ncls"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"priorlist", "[", 
    RowBox[{"[", 
     RowBox[{"wrank", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
   RowBox[{"Max", "[", 
    RowBox[{"const", ",", 
     RowBox[{
      RowBox[{"priorlist", "[", 
       RowBox[{"[", 
        RowBox[{"wrank", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
      RowBox[{"kaplist", "[", 
       RowBox[{"[", "somt", "]"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8985466809637012`*^9, 3.898546683317094*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"cea14284-251f-4036-95f7-0c8c8547918b"],

Cell[CellGroupData[{

Cell[BoxData["priorlist"], "Input",
 CellChangeTimes->{{3.898546692529551*^9, 3.8985466939827223`*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"54ff41e0-3a1c-43a0-a002-42a48748d50d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16833333333333333`", ",", "0.16833333333333333`", ",", 
   "0.16833333333333333`", ",", "0.15833333333333333`", ",", 
   "0.16833333333333333`", ",", "0.16833333333333333`"}], "}"}]], "Output",
 CellChangeTimes->{3.898546694311248*^9},
 CellLabel->
  "Out[371]=",ExpressionUUID->"9bda7ab9-0f95-4cf0-9d5b-140668b70a1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Label", "[", "somtop", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"somt", "\[Equal]", "maxT"}], ",", 
      RowBox[{"Goto", "[", "somend", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"somt", "+=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"SeedRandom", "[", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Total", "[", "uuu", "]"}], "]"}], "+", "somt"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"is", "=", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], ",", 
            RowBox[{"{", "samplesize", "}"}]}], "]"}], ",", "obsnum"}], "}"}],
         "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"loglike", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"is", "[", 
         RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mlrank", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"uuu", "[", 
           RowBox[{"[", "ss", "]"}], "]"}], ".", 
          RowBox[{"Log", "[", 
           RowBox[{"refmat", "+", "const"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"zzz", "[", 
             RowBox[{"[", "ss", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"uuu", "[", 
               RowBox[{"[", "ss", "]"}], "]"}]}], ")"}]}], ")"}], ".", 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "refmat", "+", "const"}], "]"}]}], "+", 
         RowBox[{"Log", "[", "priorlist", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wrank", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"mlrank", ",", "clsnum"}], "}"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"loglike", "+=", 
        RowBox[{"wrank", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hhh", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"hhhmat", "[", 
             RowBox[{"[", "somt", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ncls", "+", "1", "-", 
               RowBox[{"wrank", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"2", "ncls"}], "-", 
               RowBox[{"wrank", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "testlength", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"refmat", "+=", 
        RowBox[{"hhh", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uuu", "[", 
            RowBox[{"[", "ss", "]"}], "]"}], "-", "refmat"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mic", "\[Equal]", "1"}], ",", 
         RowBox[{"refmat", "=", 
          RowBox[{"Sort", "/@", "refmat"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"priorlist", "[", 
           RowBox[{"[", "r", "]"}], "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"priorlist", "[", 
              RowBox[{"[", "r", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"kaplist", "[", 
               RowBox[{"[", "somt", "]"}], "]"}], "/", "ncls"}]}]}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "ncls"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"priorlist", "[", 
         RowBox[{"[", 
          RowBox[{"wrank", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
        RowBox[{"Max", "[", 
         RowBox[{"const", ",", 
          RowBox[{
           RowBox[{"priorlist", "[", 
            RowBox[{"[", 
             RowBox[{"wrank", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"kaplist", "[", 
            RowBox[{"[", "somt", "]"}], "]"}]}]}], "]"}]}], ";"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "1", ",", "samplesize"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "loglike", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Goto", "[", "somtop", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Label", "[", "somend", "]"}], ";"}], ")"}], ";"}]], "Input",
 CellChangeTimes->{{3.8985471837740993`*^9, 3.8985471988333893`*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"84ee9373-f586-435e-bd92-d8a5f8ade47d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", "5102.535584975441`"}]], "Print",
 CellChangeTimes->{3.8985472060174007`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"aed5e7d0-a8eb-45f2-\
856d-2941b834921d"],

Cell[BoxData[
 RowBox[{"-", "5179.194628854607`"}]], "Print",
 CellChangeTimes->{3.898547206054047*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6335e405-004e-405c-\
ad20-774837c30815"],

Cell[BoxData[
 RowBox[{"-", "5178.366108846412`"}]], "Print",
 CellChangeTimes->{3.89854720609123*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"2a55e008-1cae-4a76-\
abcc-2621d28edc3d"],

Cell[BoxData[
 RowBox[{"-", "5176.027795300666`"}]], "Print",
 CellChangeTimes->{3.8985472061287622`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"b8ae1ea8-4d54-453c-\
9254-3edf3f687d90"],

Cell[BoxData[
 RowBox[{"-", "5170.474460172635`"}]], "Print",
 CellChangeTimes->{3.8985472061654577`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"65aca0e5-45f0-4f2c-\
b3f4-6ce54a644daa"],

Cell[BoxData[
 RowBox[{"-", "5177.232812618924`"}]], "Print",
 CellChangeTimes->{3.898547206202099*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"bf175f96-bf1b-4641-\
b6e6-a13f71508104"],

Cell[BoxData[
 RowBox[{"-", "5174.173179559702`"}]], "Print",
 CellChangeTimes->{3.898547206238657*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"affd3d83-5a5f-45ca-\
b67d-10fd30c8e740"],

Cell[BoxData[
 RowBox[{"-", "5171.834513198402`"}]], "Print",
 CellChangeTimes->{3.8985472062751913`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"c8f48b76-d4fe-4b29-\
9f98-9a354846340b"],

Cell[BoxData[
 RowBox[{"-", "5169.386958470775`"}]], "Print",
 CellChangeTimes->{3.898547206311303*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"3b014e5d-e6e2-4844-\
ae3e-9f064c70f136"],

Cell[BoxData[
 RowBox[{"-", "5166.155209886266`"}]], "Print",
 CellChangeTimes->{3.898547206348089*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"51892cf8-b192-4fbd-\
91ee-4aee1f814676"],

Cell[BoxData[
 RowBox[{"-", "5162.5362041507715`"}]], "Print",
 CellChangeTimes->{3.898547206384986*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"f9c1b6b5-25e7-4abf-\
9925-33a2b13327e6"],

Cell[BoxData[
 RowBox[{"-", "5161.587951229675`"}]], "Print",
 CellChangeTimes->{3.898547206422544*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"444b91ea-3fa0-4756-\
b5ca-5bfdb654f20a"],

Cell[BoxData[
 RowBox[{"-", "5155.020382773419`"}]], "Print",
 CellChangeTimes->{3.8985472064592943`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"5f7061f9-d172-43fb-\
bdae-4b1097e8bf11"],

Cell[BoxData[
 RowBox[{"-", "5161.719012896484`"}]], "Print",
 CellChangeTimes->{3.8985472064964867`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"64331edf-8720-4371-\
ba65-115da4652742"],

Cell[BoxData[
 RowBox[{"-", "5156.687502742527`"}]], "Print",
 CellChangeTimes->{3.898547206533307*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"21dfd01d-b748-4c9a-\
8f12-319fa24d8829"],

Cell[BoxData[
 RowBox[{"-", "5148.89840448783`"}]], "Print",
 CellChangeTimes->{3.898547206570676*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"c1410df9-b80a-4e7a-\
b9b4-f87f84261da7"],

Cell[BoxData[
 RowBox[{"-", "5145.93815651272`"}]], "Print",
 CellChangeTimes->{3.89854720660699*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"4fca96b0-fe5b-4cda-\
bc12-d44e1b76dbce"],

Cell[BoxData[
 RowBox[{"-", "5152.559379974956`"}]], "Print",
 CellChangeTimes->{3.898547206643037*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"cfa58fa1-50bd-48c6-\
b617-6f4b670dfda6"],

Cell[BoxData[
 RowBox[{"-", "5143.2652107049435`"}]], "Print",
 CellChangeTimes->{3.8985472066789637`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"389ee721-af1e-4257-\
ad5a-ac3b38524e10"],

Cell[BoxData[
 RowBox[{"-", "5138.309452328954`"}]], "Print",
 CellChangeTimes->{3.898547206714793*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"59fe9e2e-cd22-499d-\
a4e4-7b16f3eadd82"],

Cell[BoxData[
 RowBox[{"-", "5140.780334548109`"}]], "Print",
 CellChangeTimes->{3.8985472067510138`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"5a9850da-1cf5-4ce6-\
b77d-d5c97b8289ca"],

Cell[BoxData[
 RowBox[{"-", "5133.6172971848455`"}]], "Print",
 CellChangeTimes->{3.898547206787282*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"9d6f7fde-e7fa-4660-\
8b22-90d32030ef83"],

Cell[BoxData[
 RowBox[{"-", "5133.417928064431`"}]], "Print",
 CellChangeTimes->{3.898547206823736*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"fc8878a1-fd5c-41b2-\
b49f-e473bfc2b656"],

Cell[BoxData[
 RowBox[{"-", "5128.6391666643685`"}]], "Print",
 CellChangeTimes->{3.898547206859318*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"15276180-1e03-4d6c-\
afd7-77ab1fbb83f2"],

Cell[BoxData[
 RowBox[{"-", "5129.939467630989`"}]], "Print",
 CellChangeTimes->{3.8985472068953247`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"e69c27c6-2646-4475-\
a8c8-d17bcc9e97a3"],

Cell[BoxData[
 RowBox[{"-", "5125.840214867694`"}]], "Print",
 CellChangeTimes->{3.898547206931238*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"e19330de-8c5d-4796-\
b17e-186a2921e4e9"],

Cell[BoxData[
 RowBox[{"-", "5121.326357729426`"}]], "Print",
 CellChangeTimes->{3.898547206967353*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"82fc3b79-2dbc-47c7-\
858b-c5125240d70a"],

Cell[BoxData[
 RowBox[{"-", "5118.237710979367`"}]], "Print",
 CellChangeTimes->{3.89854720700412*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"62edc314-53f1-4124-\
b16f-ee5f76067cff"],

Cell[BoxData[
 RowBox[{"-", "5117.2559547006695`"}]], "Print",
 CellChangeTimes->{3.898547207040131*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"b5bb45a8-1c59-4bdd-\
a5fa-71dd7de701fd"],

Cell[BoxData[
 RowBox[{"-", "5112.677698623281`"}]], "Print",
 CellChangeTimes->{3.898547207076585*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"e17ee934-7232-48eb-\
a550-a04c4a66c869"],

Cell[BoxData[
 RowBox[{"-", "5111.41033017178`"}]], "Print",
 CellChangeTimes->{3.8985472071128683`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"3d583337-f582-4e64-\
8b44-18e827eab2df"],

Cell[BoxData[
 RowBox[{"-", "5107.594721790576`"}]], "Print",
 CellChangeTimes->{3.8985472071635303`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"491d8d42-8dfb-476e-\
8369-4593b4908ea0"],

Cell[BoxData[
 RowBox[{"-", "5101.035718258842`"}]], "Print",
 CellChangeTimes->{3.898547207197541*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"732a9e5f-1e1c-4839-\
8238-d9038572a229"],

Cell[BoxData[
 RowBox[{"-", "5099.189880749283`"}]], "Print",
 CellChangeTimes->{3.898547207228669*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"f8921e24-c905-4fe8-\
b253-301aa26bd365"],

Cell[BoxData[
 RowBox[{"-", "5094.2486567855185`"}]], "Print",
 CellChangeTimes->{3.898547207260043*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"7a509d1e-d374-4ec4-\
bd19-778273850099"],

Cell[BoxData[
 RowBox[{"-", "5088.285531524312`"}]], "Print",
 CellChangeTimes->{3.898547207305304*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"c5b9126f-76cc-4c66-\
a354-7813e1eb8a3e"],

Cell[BoxData[
 RowBox[{"-", "5089.288271321339`"}]], "Print",
 CellChangeTimes->{3.898547207338264*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"e2b81c34-9099-4813-\
b479-5ff03de47170"],

Cell[BoxData[
 RowBox[{"-", "5082.120294222343`"}]], "Print",
 CellChangeTimes->{3.898547207371067*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"b668f506-bc6f-41f1-\
88df-bb4d1b109612"],

Cell[BoxData[
 RowBox[{"-", "5075.252581016693`"}]], "Print",
 CellChangeTimes->{3.898547207408106*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"765ccf55-4e4d-474e-\
ac8e-a7bafebb1877"],

Cell[BoxData[
 RowBox[{"-", "5076.137750029874`"}]], "Print",
 CellChangeTimes->{3.898547207444833*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"a1498324-22f2-4d6d-\
ae83-adeebee94574"],

Cell[BoxData[
 RowBox[{"-", "5068.701120954356`"}]], "Print",
 CellChangeTimes->{3.898547207481784*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"f53f0cb2-745c-4604-\
b7a1-ba56e7a9df97"],

Cell[BoxData[
 RowBox[{"-", "5065.066825071851`"}]], "Print",
 CellChangeTimes->{3.89854720751842*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"369dcdff-97c3-4e6a-\
ad25-3bac3b5d6371"],

Cell[BoxData[
 RowBox[{"-", "5061.573422050074`"}]], "Print",
 CellChangeTimes->{3.8985472075551558`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"292f74d5-89db-4846-\
92a5-1bd05bdbdb5a"],

Cell[BoxData[
 RowBox[{"-", "5054.898896966382`"}]], "Print",
 CellChangeTimes->{3.898547207592163*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"73a0ac09-101a-40eb-\
81f0-2f687006f74a"],

Cell[BoxData[
 RowBox[{"-", "5047.327884145557`"}]], "Print",
 CellChangeTimes->{3.89854720762899*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"feccd9b4-da4f-459f-\
ac85-2f080a7723e1"],

Cell[BoxData[
 RowBox[{"-", "5045.258184692185`"}]], "Print",
 CellChangeTimes->{3.898547207665875*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"2d614857-a59e-4356-\
b3df-7f69deb03488"],

Cell[BoxData[
 RowBox[{"-", "5043.377453838961`"}]], "Print",
 CellChangeTimes->{3.898547207702887*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6682931e-f5f8-47fc-\
a51b-c03604b2e3f2"],

Cell[BoxData[
 RowBox[{"-", "5030.040968404812`"}]], "Print",
 CellChangeTimes->{3.8985472077390337`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"ad490f03-3c48-42f7-\
9ad3-666569e72f69"],

Cell[BoxData[
 RowBox[{"-", "5027.9719351000795`"}]], "Print",
 CellChangeTimes->{3.898547207775628*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"0bd9e16d-ea05-4067-\
90b1-35ebde775ba8"],

Cell[BoxData[
 RowBox[{"-", "5026.011272087222`"}]], "Print",
 CellChangeTimes->{3.898547207811545*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"8a050e40-270a-4a0a-\
b55d-86d3ced65e7e"],

Cell[BoxData[
 RowBox[{"-", "5015.523736121146`"}]], "Print",
 CellChangeTimes->{3.89854720784765*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"42519225-e9c3-457e-\
9dc0-ff45a6f38272"],

Cell[BoxData[
 RowBox[{"-", "5010.577608650481`"}]], "Print",
 CellChangeTimes->{3.898547207884512*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"f62fca39-1752-4d42-\
977f-ae7af8f57a30"],

Cell[BoxData[
 RowBox[{"-", "5005.137359208647`"}]], "Print",
 CellChangeTimes->{3.8985472079207*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"116e6ba0-65ab-4885-\
bbc2-b2ed82a94a99"],

Cell[BoxData[
 RowBox[{"-", "4997.1918316507645`"}]], "Print",
 CellChangeTimes->{3.898547207957891*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6b38dcc1-08e4-4b49-\
926f-f4e526816cae"],

Cell[BoxData[
 RowBox[{"-", "4989.770986343188`"}]], "Print",
 CellChangeTimes->{3.8985472079945107`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"7a801227-8965-405b-\
8540-073779b8c5a1"],

Cell[BoxData[
 RowBox[{"-", "4985.6826091302055`"}]], "Print",
 CellChangeTimes->{3.898547208031273*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6e3b5580-05ae-49d5-\
a2fc-802e6ed8cf73"],

Cell[BoxData[
 RowBox[{"-", "4980.031989941108`"}]], "Print",
 CellChangeTimes->{3.898547208068294*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"8027a05b-d7e0-4ca7-\
a22a-e9703cdb7add"],

Cell[BoxData[
 RowBox[{"-", "4970.7101350849025`"}]], "Print",
 CellChangeTimes->{3.898547208104845*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"534eb54b-08fd-43e2-\
8e53-665a2bc1e8ad"],

Cell[BoxData[
 RowBox[{"-", "4967.134369946349`"}]], "Print",
 CellChangeTimes->{3.898547208142029*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"93f80c0c-baa9-48da-\
9c80-cefa2bb2dd72"],

Cell[BoxData[
 RowBox[{"-", "4953.751761404164`"}]], "Print",
 CellChangeTimes->{3.89854720817833*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"128de3af-2cf7-4a31-\
98f9-aee08e99e94a"],

Cell[BoxData[
 RowBox[{"-", "4943.527886130631`"}]], "Print",
 CellChangeTimes->{3.89854720821528*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"a3b64d14-bee2-4aa1-\
9e0b-ab9660f9e342"],

Cell[BoxData[
 RowBox[{"-", "4937.40683761504`"}]], "Print",
 CellChangeTimes->{3.898547208251568*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"2bd76882-e0cd-4d08-\
b706-c4863b49ada5"],

Cell[BoxData[
 RowBox[{"-", "4931.828782909825`"}]], "Print",
 CellChangeTimes->{3.8985472082880363`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"bc0e80ae-96cf-4c5e-\
bf8b-72771f20ac05"],

Cell[BoxData[
 RowBox[{"-", "4919.7822687010275`"}]], "Print",
 CellChangeTimes->{3.898547208324304*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"cb3582db-9ba6-4ada-\
9516-f22da4a1ba86"],

Cell[BoxData[
 RowBox[{"-", "4911.762286898654`"}]], "Print",
 CellChangeTimes->{3.898547208361216*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"ef0650c3-5c03-45b7-\
84c8-7265747580bc"],

Cell[BoxData[
 RowBox[{"-", "4904.629943561135`"}]], "Print",
 CellChangeTimes->{3.898547208397131*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6ae34ac4-ade2-46fb-\
9c0f-8093748adedd"],

Cell[BoxData[
 RowBox[{"-", "4895.335759398843`"}]], "Print",
 CellChangeTimes->{3.898547208434107*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"76987dc6-0b3e-4b6b-\
9644-7a9e69bf633a"],

Cell[BoxData[
 RowBox[{"-", "4883.69439555322`"}]], "Print",
 CellChangeTimes->{3.8985472084705677`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"7b2dc554-f260-479f-\
bde0-a959ba8842b6"],

Cell[BoxData[
 RowBox[{"-", "4875.423618019997`"}]], "Print",
 CellChangeTimes->{3.898547208511548*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"aa628caa-fa8d-432c-\
93bb-b03a83484277"],

Cell[BoxData[
 RowBox[{"-", "4866.160452843762`"}]], "Print",
 CellChangeTimes->{3.898547208544529*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"617fee71-45af-4bac-\
9f0a-00437ee80e69"],

Cell[BoxData[
 RowBox[{"-", "4853.395863620064`"}]], "Print",
 CellChangeTimes->{3.8985472085911503`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"225ecb77-752b-4ea4-\
8436-1f113aab0c49"],

Cell[BoxData[
 RowBox[{"-", "4845.028863794031`"}]], "Print",
 CellChangeTimes->{3.8985472086186457`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"a52d18d8-f6c7-4b01-\
8cc0-1c70c7a0f78c"],

Cell[BoxData[
 RowBox[{"-", "4837.064958327476`"}]], "Print",
 CellChangeTimes->{3.8985472086557493`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"773ed52d-efc1-421b-\
866b-22ca00fc0590"],

Cell[BoxData[
 RowBox[{"-", "4823.154912198224`"}]], "Print",
 CellChangeTimes->{3.898547208693849*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"8b792aae-fb0b-4ae3-\
a47c-7a15a78ae26e"],

Cell[BoxData[
 RowBox[{"-", "4813.771803535857`"}]], "Print",
 CellChangeTimes->{3.898547208736248*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"cb0e6fae-eb88-4e76-\
b54d-38db810cbe18"],

Cell[BoxData[
 RowBox[{"-", "4803.114674335508`"}]], "Print",
 CellChangeTimes->{3.898547208769319*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"16ba6af3-34b2-464d-\
a8e2-9848ff3c2190"],

Cell[BoxData[
 RowBox[{"-", "4795.477737357902`"}]], "Print",
 CellChangeTimes->{3.898547208804584*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"ff623b50-74fc-4bba-\
9716-8649699f25fc"],

Cell[BoxData[
 RowBox[{"-", "4783.313830032107`"}]], "Print",
 CellChangeTimes->{3.898547208841625*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"dea961c4-5748-49d8-\
bf16-702485aebf8a"],

Cell[BoxData[
 RowBox[{"-", "4770.128389034309`"}]], "Print",
 CellChangeTimes->{3.898547208878241*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"b1bb1d91-e990-4c31-\
99e3-dd6db7ed3fc6"],

Cell[BoxData[
 RowBox[{"-", "4759.691212280965`"}]], "Print",
 CellChangeTimes->{3.898547208918404*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"b5fd259f-c663-408e-\
9726-220ef7c00ae2"],

Cell[BoxData[
 RowBox[{"-", "4750.554591971274`"}]], "Print",
 CellChangeTimes->{3.8985472089545603`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"53e415d6-5774-4fc6-\
8acc-fffe3603e6a6"],

Cell[BoxData[
 RowBox[{"-", "4741.945259199492`"}]], "Print",
 CellChangeTimes->{3.8985472089892597`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"7ca44b40-b925-4944-\
a0a0-8bda061c1d0d"],

Cell[BoxData[
 RowBox[{"-", "4730.9804687570695`"}]], "Print",
 CellChangeTimes->{3.89854720902626*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"ba23509a-d56d-4289-\
962f-7e98e96abf3b"],

Cell[BoxData[
 RowBox[{"-", "4719.722231586579`"}]], "Print",
 CellChangeTimes->{3.898547209068859*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"a9b94328-010d-4f63-\
b8a9-d05fb82cbee5"],

Cell[BoxData[
 RowBox[{"-", "4709.466463429304`"}]], "Print",
 CellChangeTimes->{3.898547209100543*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"9ca2bf87-cd83-4696-\
a839-07eae72b2ef2"],

Cell[BoxData[
 RowBox[{"-", "4698.758338176412`"}]], "Print",
 CellChangeTimes->{3.898547209138843*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"72a84dc9-de6d-41a1-\
a563-163a94cbe69b"],

Cell[BoxData[
 RowBox[{"-", "4690.6109074497035`"}]], "Print",
 CellChangeTimes->{3.8985472091743803`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"716a3b33-93a0-4ab6-\
8587-4bdd242813d5"],

Cell[BoxData[
 RowBox[{"-", "4679.790630759715`"}]], "Print",
 CellChangeTimes->{3.898547209211027*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"a710629f-7e18-4794-\
ae02-7300c134fa8c"],

Cell[BoxData[
 RowBox[{"-", "4672.072287664661`"}]], "Print",
 CellChangeTimes->{3.89854720924732*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"487fd1fa-cceb-4e4a-\
a78d-97c9a622ed5f"],

Cell[BoxData[
 RowBox[{"-", "4663.602719455725`"}]], "Print",
 CellChangeTimes->{3.8985472092844152`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"8cab6b84-4e6e-49f9-\
8cf6-c16f052b000e"],

Cell[BoxData[
 RowBox[{"-", "4655.115572316734`"}]], "Print",
 CellChangeTimes->{3.898547209321299*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"6c63a7e4-c2da-46b9-\
8b34-7c4bd67f8531"],

Cell[BoxData[
 RowBox[{"-", "4645.68176649537`"}]], "Print",
 CellChangeTimes->{3.8985472093583403`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"73d1a0bc-23a1-44f2-\
a271-f57591cb5f86"],

Cell[BoxData[
 RowBox[{"-", "4637.764271905585`"}]], "Print",
 CellChangeTimes->{3.898547209394849*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"261cd694-d21a-4c4a-\
9a2d-ef78557d54a9"],

Cell[BoxData[
 RowBox[{"-", "4630.634099395198`"}]], "Print",
 CellChangeTimes->{3.898547209431364*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"5d99c387-51bc-4ddd-\
b473-4e68721f2125"],

Cell[BoxData[
 RowBox[{"-", "4623.633551040066`"}]], "Print",
 CellChangeTimes->{3.898547209467992*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"d3dced60-c9d6-4e5e-\
8923-35162bb2047b"],

Cell[BoxData[
 RowBox[{"-", "4616.817965586271`"}]], "Print",
 CellChangeTimes->{3.8985472095043173`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"98bb020c-f96d-450d-\
9212-3e3f35c28841"],

Cell[BoxData[
 RowBox[{"-", "4610.909268314048`"}]], "Print",
 CellChangeTimes->{3.898547209541157*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"7c2610de-e48c-4ec1-\
9a7b-8f1c2cd17382"],

Cell[BoxData[
 RowBox[{"-", "4606.36789815642`"}]], "Print",
 CellChangeTimes->{3.8985472095777187`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"9be51aaf-1bd2-43c1-\
930f-df93abc55d96"],

Cell[BoxData[
 RowBox[{"-", "4603.583686387464`"}]], "Print",
 CellChangeTimes->{3.8985472096144238`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[372]:=",ExpressionUUID->"2a3a363a-65fe-4ae2-\
9349-a77486f65808"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"llmat", "=", 
    RowBox[{
     RowBox[{"uuu", ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Log", "[", 
        RowBox[{"clsrefmat", "+", "const"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zzz", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "uuu"}], ")"}]}], ")"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "clsrefmat", "+", "const"}], "]"}], "]"}]}]}]}], 
   ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"S", "*", "C"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expllmat", "=", 
    RowBox[{"Exp", "[", "llmat", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"S", "*", "C"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"postdist", "=", 
   RowBox[{"expllmat", "/", 
    RowBox[{"Total", "[", 
     RowBox[{"Transpose", "[", "expllmat", "]"}], "]"}]}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{"S", "*", "C"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{3.898547577308112*^9},
 CellLabel->
  "In[373]:=",ExpressionUUID->"583a686d-9f5c-4aed-9ebf-26a155dd9fb4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"postdist", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.898547583720541*^9, 3.898547605997017*^9}, {
  3.898547715440345*^9, 3.898547748286131*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"7da08f01-8cd3-40fa-bf2e-75ed2b54d317"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0008672682319305703`", ",", "0.06196139381220176`", ",", 
   "0.33302761374152157`", ",", "0.44403673908681407`", ",", 
   "0.1549033850214065`", ",", "0.005203600106125548`"}], "}"}]], "Output",
 CellChangeTimes->{{3.898547585814494*^9, 3.898547606386283*^9}, {
  3.898547717693707*^9, 3.898547748779126*^9}},
 CellLabel->
  "Out[382]=",ExpressionUUID->"518b4263-9ad1-4114-9d14-844c36a41db5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fil", "=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"ncls", "<", "5"}], ",", 
     RowBox[{"1.05", "-", 
      RowBox[{".05", "*", "ncls"}]}], ",", 
     RowBox[{"ncls", "<", "10"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"0.04", "*", "ncls"}]}], ",", 
     RowBox[{"ncls", "\[GreaterEqual]", "10"}], ",", 
     RowBox[{"0.8", "-", 
      RowBox[{"0.02", "*", "ncls"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filmat1", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "fil"}], ")"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"ncls", "-", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filmat2", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"fil", ",", 
      RowBox[{"{", "ncls", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filmat", "=", 
   RowBox[{"filmat1", "+", 
    RowBox[{"Transpose", "[", "filmat1", "]"}], "+", "filmat2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.898818836168829*^9, 3.8988188464455833`*^9}, {
  3.898819458281958*^9, 3.898819462101432*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"eb4bc91b-1eab-4994-aa89-393ea4b6771e"],

Cell[CellGroupData[{

Cell[BoxData["filmat1"], "Input",
 CellChangeTimes->{{3.898818836168829*^9, 3.8988188464455833`*^9}, {
   3.898819458281958*^9, 3.898819478268859*^9}, 3.898819527390657*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"cac1cd11-a3e9-44b6-a80b-cdb07fde7699"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.12`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.12`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.12`", ",", "0.`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.12`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.12`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8988194842891703`*^9, 3.898819528050828*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"422f60c5-2cd3-4127-b081-3e840ec5672c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"filmat", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"filmat", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"Total", "[", 
     RowBox[{"filmat", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filmat", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"filmat", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "/", 
    RowBox[{"Total", "[", 
     RowBox[{"filmat", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.898818836168829*^9, 3.8988188464455833`*^9}, {
  3.898819458281958*^9, 
  3.898819473990556*^9}},ExpressionUUID->"7871f5d5-5f2b-452f-b1b9-\
72b4168db72b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"filmat", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"Total", "[", 
    RowBox[{"filmat", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.898818852308257*^9, 3.8988188530627213`*^9}, {
  3.898819371063498*^9, 3.8988193730048847`*^9}, {3.8988194228248177`*^9, 
  3.898819442488356*^9}, {3.898820326601432*^9, 3.898820373424492*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"99e59ddb-6059-428c-8aa8-dd2425d1c5d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.8636363636363638`", ",", "0.13636363636363638`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.898818854647417*^9, 3.898819373802411*^9, {3.898819423732188*^9, 
   3.898819442966651*^9}, {3.898820330270599*^9, 3.898820374005782*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"0c8ba8ce-0aee-4135-aa1f-5fa83227d5f6"]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{-1555, Automatic}, {128, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (2023\:5e746\:67083\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1458a554-9d20-455c-907f-87e83dabe7b9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2799, 87, 388, "Input",ExpressionUUID->"bdb27c93-289a-402e-8ed5-52ca9b86edb4"],
Cell[CellGroupData[{
Cell[3404, 113, 323, 6, 29, "Print",ExpressionUUID->"de679119-6f4a-4215-83cd-63a722767001"],
Cell[3730, 121, 1121, 30, 193, "Print",ExpressionUUID->"eb8bbfb0-8879-4a38-b153-a179a5b913d8"],
Cell[4854, 153, 321, 6, 29, "Print",ExpressionUUID->"8d8690e9-a14a-4906-bfc1-b9b657783e4f"],
Cell[5178, 161, 2483, 51, 327, "Print",ExpressionUUID->"4f5adac4-3102-4122-a0cb-db06a052c281"]
}, Open  ]]
}, Open  ]],
Cell[7688, 216, 109, 2, 37, "Input",ExpressionUUID->"046d7bc3-ac91-4620-b146-a2120185cab1"],
Cell[7800, 220, 4736, 148, 693, "Input",ExpressionUUID->"0918c56e-7ab3-4bee-8162-5511bcd31d03"],
Cell[CellGroupData[{
Cell[12561, 372, 624, 11, 37, "Input",ExpressionUUID->"f68ffab5-103e-4060-997e-341cad9bdb0a"],
Cell[13188, 385, 606, 11, 42, "Output",ExpressionUUID->"d61265f5-3e7b-49f1-b889-c51c043c5cdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13831, 401, 331, 5, 37, "Input",ExpressionUUID->"a6111750-f656-4121-bce5-fe92a2a5f831"],
Cell[14165, 408, 602, 12, 42, "Output",ExpressionUUID->"27a73548-08fd-4c84-9a06-a8a00df6fcda"]
}, Open  ]],
Cell[14782, 423, 947, 29, 154, "Input",ExpressionUUID->"dbfbb01a-9e76-4a51-bdc2-461cf4690eff"],
Cell[CellGroupData[{
Cell[15754, 456, 316, 7, 54, "Input",ExpressionUUID->"c53d326e-5351-4b19-b07f-46a82970d9e8"],
Cell[16073, 465, 230, 5, 42, "Output",ExpressionUUID->"22d32180-886f-4e62-af3d-2d5fa308d84b"]
}, Open  ]],
Cell[16318, 473, 1289, 39, 151, "Input",ExpressionUUID->"f8681ab5-f7ce-4b63-9812-9589d8604f98"],
Cell[CellGroupData[{
Cell[17632, 516, 233, 4, 37, "Input",ExpressionUUID->"6d69c509-6463-42e6-9509-7057121cf4ae"],
Cell[17868, 522, 358, 8, 42, "Output",ExpressionUUID->"a60030b1-bb7e-4867-ac3e-57f10d991d88"]
}, Open  ]],
Cell[18241, 533, 307, 8, 37, "Input",ExpressionUUID->"b37e64a8-83a7-4695-99cd-b021b100e1ad"],
Cell[CellGroupData[{
Cell[18573, 545, 885, 24, 83, "Input",ExpressionUUID->"bd0aa962-a8f6-4e78-a74a-a94b6877c600"],
Cell[19461, 571, 3595, 81, 225, "Output",ExpressionUUID->"241117e8-3653-4e4d-a23e-194fb596b8d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23093, 657, 330, 7, 37, "Input",ExpressionUUID->"bac64ef3-18e3-4237-8e0c-bd1e311fbd3e"],
Cell[23426, 666, 4305, 101, 225, "Output",ExpressionUUID->"cbf151cf-1853-48b6-8be3-73d038ae2d38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27768, 772, 553, 13, 64, "Input",ExpressionUUID->"f03e620f-4e8a-4638-a0e9-32ee81a6698d"],
Cell[28324, 787, 3718, 83, 225, "Output",ExpressionUUID->"baaf4d84-a01c-44a2-951e-e52b381f41bf"]
}, Open  ]],
Cell[32057, 873, 1166, 36, 99, "Input",ExpressionUUID->"cea14284-251f-4036-95f7-0c8c8547918b"],
Cell[CellGroupData[{
Cell[33248, 913, 186, 3, 37, "Input",ExpressionUUID->"54ff41e0-3a1c-43a0-a002-42a48748d50d"],
Cell[33437, 918, 363, 8, 42, "Output",ExpressionUUID->"9bda7ab9-0f95-4cf0-9d5b-140668b70a1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33837, 931, 5196, 138, 743, "Input",ExpressionUUID->"84ee9373-f586-435e-bd92-d8a5f8ade47d"],
Cell[CellGroupData[{
Cell[39058, 1073, 214, 5, 29, "Print",ExpressionUUID->"aed5e7d0-a8eb-45f2-856d-2941b834921d"],
Cell[39275, 1080, 212, 5, 29, "Print",ExpressionUUID->"6335e405-004e-405c-ad20-774837c30815"],
Cell[39490, 1087, 211, 5, 29, "Print",ExpressionUUID->"2a55e008-1cae-4a76-abcc-2621d28edc3d"],
Cell[39704, 1094, 214, 5, 29, "Print",ExpressionUUID->"b8ae1ea8-4d54-453c-9254-3edf3f687d90"],
Cell[39921, 1101, 214, 5, 29, "Print",ExpressionUUID->"65aca0e5-45f0-4f2c-b3f4-6ce54a644daa"],
Cell[40138, 1108, 212, 5, 29, "Print",ExpressionUUID->"bf175f96-bf1b-4641-b6e6-a13f71508104"],
Cell[40353, 1115, 212, 5, 29, "Print",ExpressionUUID->"affd3d83-5a5f-45ca-b67d-10fd30c8e740"],
Cell[40568, 1122, 214, 5, 29, "Print",ExpressionUUID->"c8f48b76-d4fe-4b29-9f98-9a354846340b"],
Cell[40785, 1129, 212, 5, 29, "Print",ExpressionUUID->"3b014e5d-e6e2-4844-ae3e-9f064c70f136"],
Cell[41000, 1136, 212, 5, 29, "Print",ExpressionUUID->"51892cf8-b192-4fbd-91ee-4aee1f814676"],
Cell[41215, 1143, 213, 5, 29, "Print",ExpressionUUID->"f9c1b6b5-25e7-4abf-9925-33a2b13327e6"],
Cell[41431, 1150, 212, 5, 29, "Print",ExpressionUUID->"444b91ea-3fa0-4756-b5ca-5bfdb654f20a"],
Cell[41646, 1157, 214, 5, 29, "Print",ExpressionUUID->"5f7061f9-d172-43fb-bdae-4b1097e8bf11"],
Cell[41863, 1164, 214, 5, 29, "Print",ExpressionUUID->"64331edf-8720-4371-ba65-115da4652742"],
Cell[42080, 1171, 212, 5, 29, "Print",ExpressionUUID->"21dfd01d-b748-4c9a-8f12-319fa24d8829"],
Cell[42295, 1178, 211, 5, 29, "Print",ExpressionUUID->"c1410df9-b80a-4e7a-b9b4-f87f84261da7"],
Cell[42509, 1185, 210, 5, 29, "Print",ExpressionUUID->"4fca96b0-fe5b-4cda-bc12-d44e1b76dbce"],
Cell[42722, 1192, 212, 5, 29, "Print",ExpressionUUID->"cfa58fa1-50bd-48c6-b617-6f4b670dfda6"],
Cell[42937, 1199, 215, 5, 29, "Print",ExpressionUUID->"389ee721-af1e-4257-ad5a-ac3b38524e10"],
Cell[43155, 1206, 212, 5, 29, "Print",ExpressionUUID->"59fe9e2e-cd22-499d-a4e4-7b16f3eadd82"],
Cell[43370, 1213, 214, 5, 29, "Print",ExpressionUUID->"5a9850da-1cf5-4ce6-b77d-d5c97b8289ca"],
Cell[43587, 1220, 213, 5, 29, "Print",ExpressionUUID->"9d6f7fde-e7fa-4660-8b22-90d32030ef83"],
Cell[43803, 1227, 212, 5, 29, "Print",ExpressionUUID->"fc8878a1-fd5c-41b2-b49f-e473bfc2b656"],
Cell[44018, 1234, 213, 5, 29, "Print",ExpressionUUID->"15276180-1e03-4d6c-afd7-77ab1fbb83f2"],
Cell[44234, 1241, 214, 5, 29, "Print",ExpressionUUID->"e69c27c6-2646-4475-a8c8-d17bcc9e97a3"],
Cell[44451, 1248, 212, 5, 29, "Print",ExpressionUUID->"e19330de-8c5d-4796-b17e-186a2921e4e9"],
Cell[44666, 1255, 212, 5, 29, "Print",ExpressionUUID->"82fc3b79-2dbc-47c7-858b-c5125240d70a"],
Cell[44881, 1262, 211, 5, 29, "Print",ExpressionUUID->"62edc314-53f1-4124-b16f-ee5f76067cff"],
Cell[45095, 1269, 213, 5, 29, "Print",ExpressionUUID->"b5bb45a8-1c59-4bdd-a5fa-71dd7de701fd"],
Cell[45311, 1276, 212, 5, 29, "Print",ExpressionUUID->"e17ee934-7232-48eb-a550-a04c4a66c869"],
Cell[45526, 1283, 213, 5, 29, "Print",ExpressionUUID->"3d583337-f582-4e64-8b44-18e827eab2df"],
Cell[45742, 1290, 214, 5, 29, "Print",ExpressionUUID->"491d8d42-8dfb-476e-8369-4593b4908ea0"],
Cell[45959, 1297, 212, 5, 29, "Print",ExpressionUUID->"732a9e5f-1e1c-4839-8238-d9038572a229"],
Cell[46174, 1304, 212, 5, 29, "Print",ExpressionUUID->"f8921e24-c905-4fe8-b253-301aa26bd365"],
Cell[46389, 1311, 213, 5, 29, "Print",ExpressionUUID->"7a509d1e-d374-4ec4-bd19-778273850099"],
Cell[46605, 1318, 212, 5, 29, "Print",ExpressionUUID->"c5b9126f-76cc-4c66-a354-7813e1eb8a3e"],
Cell[46820, 1325, 212, 5, 29, "Print",ExpressionUUID->"e2b81c34-9099-4813-b479-5ff03de47170"],
Cell[47035, 1332, 212, 5, 29, "Print",ExpressionUUID->"b668f506-bc6f-41f1-88df-bb4d1b109612"],
Cell[47250, 1339, 212, 5, 29, "Print",ExpressionUUID->"765ccf55-4e4d-474e-ac8e-a7bafebb1877"],
Cell[47465, 1346, 212, 5, 29, "Print",ExpressionUUID->"a1498324-22f2-4d6d-ae83-adeebee94574"],
Cell[47680, 1353, 212, 5, 29, "Print",ExpressionUUID->"f53f0cb2-745c-4604-b7a1-ba56e7a9df97"],
Cell[47895, 1360, 211, 5, 29, "Print",ExpressionUUID->"369dcdff-97c3-4e6a-ad25-3bac3b5d6371"],
Cell[48109, 1367, 214, 5, 29, "Print",ExpressionUUID->"292f74d5-89db-4846-92a5-1bd05bdbdb5a"],
Cell[48326, 1374, 212, 5, 29, "Print",ExpressionUUID->"73a0ac09-101a-40eb-81f0-2f687006f74a"],
Cell[48541, 1381, 211, 5, 29, "Print",ExpressionUUID->"feccd9b4-da4f-459f-ac85-2f080a7723e1"],
Cell[48755, 1388, 212, 5, 29, "Print",ExpressionUUID->"2d614857-a59e-4356-b3df-7f69deb03488"],
Cell[48970, 1395, 212, 5, 29, "Print",ExpressionUUID->"6682931e-f5f8-47fc-a51b-c03604b2e3f2"],
Cell[49185, 1402, 214, 5, 29, "Print",ExpressionUUID->"ad490f03-3c48-42f7-9ad3-666569e72f69"],
Cell[49402, 1409, 213, 5, 29, "Print",ExpressionUUID->"0bd9e16d-ea05-4067-90b1-35ebde775ba8"],
Cell[49618, 1416, 212, 5, 29, "Print",ExpressionUUID->"8a050e40-270a-4a0a-b55d-86d3ced65e7e"],
Cell[49833, 1423, 211, 5, 29, "Print",ExpressionUUID->"42519225-e9c3-457e-9dc0-ff45a6f38272"],
Cell[50047, 1430, 212, 5, 29, "Print",ExpressionUUID->"f62fca39-1752-4d42-977f-ae7af8f57a30"],
Cell[50262, 1437, 210, 5, 29, "Print",ExpressionUUID->"116e6ba0-65ab-4885-bbc2-b2ed82a94a99"],
Cell[50475, 1444, 213, 5, 29, "Print",ExpressionUUID->"6b38dcc1-08e4-4b49-926f-f4e526816cae"],
Cell[50691, 1451, 214, 5, 29, "Print",ExpressionUUID->"7a801227-8965-405b-8540-073779b8c5a1"],
Cell[50908, 1458, 213, 5, 29, "Print",ExpressionUUID->"6e3b5580-05ae-49d5-a2fc-802e6ed8cf73"],
Cell[51124, 1465, 212, 5, 29, "Print",ExpressionUUID->"8027a05b-d7e0-4ca7-a22a-e9703cdb7add"],
Cell[51339, 1472, 213, 5, 29, "Print",ExpressionUUID->"534eb54b-08fd-43e2-8e53-665a2bc1e8ad"],
Cell[51555, 1479, 212, 5, 29, "Print",ExpressionUUID->"93f80c0c-baa9-48da-9c80-cefa2bb2dd72"],
Cell[51770, 1486, 211, 5, 29, "Print",ExpressionUUID->"128de3af-2cf7-4a31-98f9-aee08e99e94a"],
Cell[51984, 1493, 211, 5, 29, "Print",ExpressionUUID->"a3b64d14-bee2-4aa1-9e0b-ab9660f9e342"],
Cell[52198, 1500, 211, 5, 29, "Print",ExpressionUUID->"2bd76882-e0cd-4d08-b706-c4863b49ada5"],
Cell[52412, 1507, 214, 5, 29, "Print",ExpressionUUID->"bc0e80ae-96cf-4c5e-bf8b-72771f20ac05"],
Cell[52629, 1514, 213, 5, 29, "Print",ExpressionUUID->"cb3582db-9ba6-4ada-9516-f22da4a1ba86"],
Cell[52845, 1521, 212, 5, 29, "Print",ExpressionUUID->"ef0650c3-5c03-45b7-84c8-7265747580bc"],
Cell[53060, 1528, 212, 5, 29, "Print",ExpressionUUID->"6ae34ac4-ade2-46fb-9c0f-8093748adedd"],
Cell[53275, 1535, 212, 5, 29, "Print",ExpressionUUID->"76987dc6-0b3e-4b6b-9644-7a9e69bf633a"],
Cell[53490, 1542, 213, 5, 29, "Print",ExpressionUUID->"7b2dc554-f260-479f-bde0-a959ba8842b6"],
Cell[53706, 1549, 212, 5, 29, "Print",ExpressionUUID->"aa628caa-fa8d-432c-93bb-b03a83484277"],
Cell[53921, 1556, 212, 5, 29, "Print",ExpressionUUID->"617fee71-45af-4bac-9f0a-00437ee80e69"],
Cell[54136, 1563, 214, 5, 29, "Print",ExpressionUUID->"225ecb77-752b-4ea4-8436-1f113aab0c49"],
Cell[54353, 1570, 214, 5, 29, "Print",ExpressionUUID->"a52d18d8-f6c7-4b01-8cc0-1c70c7a0f78c"],
Cell[54570, 1577, 214, 5, 29, "Print",ExpressionUUID->"773ed52d-efc1-421b-866b-22ca00fc0590"],
Cell[54787, 1584, 212, 5, 29, "Print",ExpressionUUID->"8b792aae-fb0b-4ae3-a47c-7a15a78ae26e"],
Cell[55002, 1591, 212, 5, 29, "Print",ExpressionUUID->"cb0e6fae-eb88-4e76-b54d-38db810cbe18"],
Cell[55217, 1598, 212, 5, 29, "Print",ExpressionUUID->"16ba6af3-34b2-464d-a8e2-9848ff3c2190"],
Cell[55432, 1605, 212, 5, 29, "Print",ExpressionUUID->"ff623b50-74fc-4bba-9716-8649699f25fc"],
Cell[55647, 1612, 212, 5, 29, "Print",ExpressionUUID->"dea961c4-5748-49d8-bf16-702485aebf8a"],
Cell[55862, 1619, 212, 5, 29, "Print",ExpressionUUID->"b1bb1d91-e990-4c31-99e3-dd6db7ed3fc6"],
Cell[56077, 1626, 212, 5, 29, "Print",ExpressionUUID->"b5fd259f-c663-408e-9726-220ef7c00ae2"],
Cell[56292, 1633, 214, 5, 29, "Print",ExpressionUUID->"53e415d6-5774-4fc6-8acc-fffe3603e6a6"],
Cell[56509, 1640, 214, 5, 29, "Print",ExpressionUUID->"7ca44b40-b925-4944-a0a0-8bda061c1d0d"],
Cell[56726, 1647, 212, 5, 29, "Print",ExpressionUUID->"ba23509a-d56d-4289-962f-7e98e96abf3b"],
Cell[56941, 1654, 212, 5, 29, "Print",ExpressionUUID->"a9b94328-010d-4f63-b8a9-d05fb82cbee5"],
Cell[57156, 1661, 212, 5, 29, "Print",ExpressionUUID->"9ca2bf87-cd83-4696-a839-07eae72b2ef2"],
Cell[57371, 1668, 212, 5, 29, "Print",ExpressionUUID->"72a84dc9-de6d-41a1-a563-163a94cbe69b"],
Cell[57586, 1675, 215, 5, 29, "Print",ExpressionUUID->"716a3b33-93a0-4ab6-8587-4bdd242813d5"],
Cell[57804, 1682, 212, 5, 29, "Print",ExpressionUUID->"a710629f-7e18-4794-ae02-7300c134fa8c"],
Cell[58019, 1689, 211, 5, 29, "Print",ExpressionUUID->"487fd1fa-cceb-4e4a-a78d-97c9a622ed5f"],
Cell[58233, 1696, 214, 5, 29, "Print",ExpressionUUID->"8cab6b84-4e6e-49f9-8cf6-c16f052b000e"],
Cell[58450, 1703, 212, 5, 29, "Print",ExpressionUUID->"6c63a7e4-c2da-46b9-8b34-7c4bd67f8531"],
Cell[58665, 1710, 213, 5, 29, "Print",ExpressionUUID->"73d1a0bc-23a1-44f2-a271-f57591cb5f86"],
Cell[58881, 1717, 212, 5, 29, "Print",ExpressionUUID->"261cd694-d21a-4c4a-9a2d-ef78557d54a9"],
Cell[59096, 1724, 212, 5, 29, "Print",ExpressionUUID->"5d99c387-51bc-4ddd-b473-4e68721f2125"],
Cell[59311, 1731, 212, 5, 29, "Print",ExpressionUUID->"d3dced60-c9d6-4e5e-8923-35162bb2047b"],
Cell[59526, 1738, 214, 5, 29, "Print",ExpressionUUID->"98bb020c-f96d-450d-9212-3e3f35c28841"],
Cell[59743, 1745, 212, 5, 29, "Print",ExpressionUUID->"7c2610de-e48c-4ec1-9a7b-8f1c2cd17382"],
Cell[59958, 1752, 213, 5, 29, "Print",ExpressionUUID->"9be51aaf-1bd2-43c1-930f-df93abc55d96"],
Cell[60174, 1759, 214, 5, 29, "Print",ExpressionUUID->"2a3a363a-65fe-4ae2-9349-a77486f65808"]
}, Open  ]]
}, Open  ]],
Cell[60415, 1768, 1158, 35, 173, "Input",ExpressionUUID->"583a686d-9f5c-4aed-9ebf-26a155dd9fb4"],
Cell[CellGroupData[{
Cell[61598, 1807, 282, 6, 37, "Input",ExpressionUUID->"7da08f01-8cd3-40fa-bf2e-75ed2b54d317"],
Cell[61883, 1815, 438, 9, 42, "Output",ExpressionUUID->"518b4263-9ad1-4114-9d14-844c36a41db5"]
}, Open  ]],
Cell[62336, 1827, 1384, 41, 189, "Input",ExpressionUUID->"eb4bc91b-1eab-4994-aa89-393ea4b6771e"],
Cell[CellGroupData[{
Cell[63745, 1872, 252, 3, 37, "Input",ExpressionUUID->"cac1cd11-a3e9-44b6-a80b-cdb07fde7699"],
Cell[64000, 1877, 934, 28, 69, "Output",ExpressionUUID->"422f60c5-2cd3-4127-b081-3e840ec5672c"]
}, Open  ]],
Cell[64949, 1908, 862, 27, 99, "Input",ExpressionUUID->"7871f5d5-5f2b-452f-b1b9-72b4168db72b"],
Cell[CellGroupData[{
Cell[65836, 1939, 536, 12, 83, "Input",ExpressionUUID->"99e59ddb-6059-428c-8aa8-dd2425d1c5d9"],
Cell[66375, 1953, 407, 8, 62, "Output",ExpressionUUID->"0c8ba8ce-0aee-4135-aa1f-5fa83227d5f6"]
}, Open  ]]
}
]
*)

